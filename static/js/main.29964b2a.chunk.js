(this.webpackJsonpletsgodutch=this.webpackJsonpletsgodutch||[]).push([[0],{382:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(40),i=n.n(c),o=n(62),u=(n(263),n(384)),s=n(390),l=n(228),d=n(198),b=n(197),j=(n(275),new URLSearchParams(window.location.search)),p=Object.fromEntries(j.entries()),O=!1,f=null;if(p.apiKey&&p.authDomain&&p.projectId)try{d.a.initializeApp(p),f=d.a.firestore()}catch(qn){f=new b.a("db")}else O=!0,f=new b.a("db");var v,h,x,m=f,g=function(){return m.collection("records")},y=function(){return m.collection("users")},S=function(e){return["SUCCESS","FAILURE","REQUEST"].reduce((function(t,n){var r="".concat(e,"_").concat(n);return t[n]=r,t[n.toLowerCase()]=function(e){return{type:r,data:e,httpState:n}},t}),{})},k=S("RECORDS__LOAD_ALL_RECORD"),C=S("RECORDS__ADD_RECORD"),w=S("RECORDS__UPDATE_RECORD"),E=S("RECORDS__REMOVE_RECORD"),R=k.request,T=C.request,L=w.request,I=E.request,F=S("USER__LOAD_ALL_USERS"),U=S("USER__ADD_USER"),A=F.request,N=U.request,V=n(233),B=n(385),_=n(41),D=n(23),M=n(48),Q=n(49),P=n(80),z=n(94),q=n.n(z),G=n(140),H=n.n(G),K=n(71),W="#1890ff",J=H()(W).darken(.3).hex(),Y=H()(W).brighten(.4).hex(),X="#FFFFFB",Z={primaryBackground:W,primaryBackgroundDark:J,primaryBackgroundLight:Y,mark:"#C7802D",error:"#f50",white:X,getGray:function(e){return H.a.scale([X,"#080808"])(e).hex()},getbalanceColor:function(e){return H.a.scale([K.c[2],"#fff",K.b[2]]).domain([-1e3,1e3])(e).hex()}},$=n(73),ee=n(14),te=function(){var e={},t=[],n={};return function(r){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{filter:{targeted:!0}};return r===e&&n===a?t:(e=r,n=a,t=Object.entries(r).filter((function(e){return Object.entries(a.filter).every((function(t){var n,r=Object(D.a)(t,2),a=r[0],c=r[1];return(null===e||void 0===e||null===(n=e[1])||void 0===n?void 0:n[a])===c}))})))}}(),ne=function(){var e={},t={};return function(n){return n!==e&&(e=n,t={delivery:{fee:0},discount:{amount:0},participants:Object.keys(n).reduce((function(e,t){return Object(ee.a)(Object(ee.a)({},e),{},Object($.a)({},t,{key:t,name:t,targeted:!0,selected:!1,cost:""}))}),{}),payer:""}),t}}(),re=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.fixDigit,r=void 0===n?2:n,a=Math.pow(10,r);return Math.round((e+Number.EPSILON)*a)/a},ae=n(8),ce=Q.a.span(v||(v=Object(M.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  padding-left: 16px;\n"]))),ie=function(e){var t=function(e){return e.reduce((function(e,t){var n=t.participants,r=t.payer,a=t.delivery,c=t.discount;if(0===Object.keys(n).length)return e;var i=((null===a||void 0===a?void 0:a.fee)||0)-((null===c||void 0===c?void 0:c.amount)||0),o=te(n),u=i/o.length,s=i;return o.forEach((function(t){var n=Object(D.a)(t,2),r=n[0],a=n[1].cost,c=void 0===a?0:a;e[r]=(e[r]||0)-c-u,s+=c})),e[r]+=s,e}),{})}(e),n=Object.keys(t).map((function(e){var n=re(t[e]);return{title:e,render:function(e){return e||0},children:[{title:Object(ae.jsx)(ce,{style:{background:Z.getbalanceColor(n)},children:n}),dataIndex:e,key:e,width:100}],balance:n}}));return n.sort((function(e,t){return e.balance-t.balance})),[{title:"\u65e5\u671f",dataIndex:"date",key:"date",width:80,fixed:"left",defaultSortOrder:"descend",sorter:function(e,t){return e.date.date-t.date.date},sortDirections:["ascend"],render:function(e){var t=e.date,n=q()(t);return Object(ae.jsx)(P.a,{title:n.format("yyyy-M-D H:mm"),children:n.format("M/D")})}},{title:"\u4ed8\u6b3e\u4eba",dataIndex:"payer",key:"payer",width:100,fixed:"left",render:function(e){return e.payer}},{title:"\u5171\u4eab",dataIndex:"sharingFee",key:"sharingFee",width:80,fixed:"left"}].concat(Object(_.a)(n),[{title:"\u7e3d\u984d",dataIndex:"totalAmount",key:"totalAmount",fixed:"right",width:100},{title:"\u5099\u8a3b",dataIndex:"note",key:"note",ellipsis:{showTitle:!1},render:function(e){return Object(ae.jsx)(P.a,{title:e,children:e})},width:175,fixed:"right"},{title:"Action",dataIndex:"action",key:"action",width:100,fixed:"right"}])},oe=n(387),ue=n(394),se=n(395),le=n(51),de=n(388),be=Object(Q.a)(le.a)(h||(h=Object(M.a)(["\n  color: #eee;\n  margin-right: 8px;\n  height: 48px;\n  border-radius: 16px;\n  &:hover {\n    color: #fff;\n    background: rgba(255, 255, 255, 0.2);\n    box-shadow: rgba(255, 255, 255, 0.3) 0px 0px 8px 0px;\n  }\n  &:active {\n    color: #fff;\n    background: rgba(255, 255, 255, 0.1);\n    box-shadow: rgba(255, 255, 255, 0.7) 0px 0px 8px 4px;\n  }\n  &:focus {\n    color: #eee;\n  }\n"]))),je=Object(Q.a)(de.a)(x||(x=Object(M.a)(["\n  &::-webkit-scrollbar {\n    display: none;\n  }\n"]))),pe=function(e){var t=e.button,n=e.buttonTitle,a=void 0===n?"Open Modal":n,c=e.okFunction,i=e.loading,o=void 0!==i&&i,u=e.children,s=Object(r.useState)(!1),l=Object(D.a)(s,2),d=l[0],b=l[1],j=function(){b(!0)};return Object(ae.jsxs)(ae.Fragment,{children:[t?Object(r.cloneElement)(t,{onClick:j}):Object(ae.jsx)(be,{loading:o,type:"text",onClick:j,children:a}),Object(ae.jsx)(je,{visible:d,onOk:function(){c(),b(!1)},onCancel:function(){b(!1)},footer:null,centered:!0,style:{overflow:"auto",maxWidth:"448px"},children:Object(ae.jsx)(V.a,{spinning:o,children:r.Children.map(u,(function(e){return Object(r.cloneElement)(e,{isModalVisible:d,setIsModalVisible:b})}))})})]})},Oe=n(43),fe=n(77),ve=n(74),he=n(54),xe=["children","onSubmit"],me=function(e){var t,n=a.a.Children.toArray(e),r=Object(ve.a)(n);try{for(r.s();!(t=r.n()).done;){var c=t.value;if("StepsList"===c.type.displayName)return c.props.children.length-1}}catch(i){r.e(i)}finally{r.f()}throw new Error("Require StepsList")},ge=function(e){var t=e.children,n=e.onSubmit,a=Object(Oe.a)(e,xe),c=Object(r.useState)({activeStepIndex:0,totalSteps:me(t),stepTabs:[],direction:0}),i=Object(D.a)(c,2),o=i[0],u=i[1],s=function(){return u(Object(he.a)(o,(function(e){e.activeStepIndex=o.activeStepIndex-1,e.direction=-1})))},l=function(){return u(Object(he.a)(o,(function(e){e.activeStepIndex=o.activeStepIndex+1,e.direction=1})))},d=n?function(){n(a.values),a.setIsModalVisible(!1),a.setValues(a.initialValues),u(Object(he.a)(o,(function(e){e.activeStepIndex=0,e.direction=0})))}:function(){},b=function(e){return u(Object(he.a)(o,(function(t){t.stepTabs=e})))},j=function(){var e=null,n=null,c=[];return r.Children.forEach(t,(function(t){"StepsList"===t.type.displayName&&(e=Object(r.cloneElement)(t,Object(ee.a)({activeStepIndex:o.activeStepIndex,updateStepTabs:b,direction:o.direction},a)),t.props.validators&&(c=t.props.validators)),"ButtonsList"===t.type.displayName&&(n=Object(r.cloneElement)(t,Object(ee.a)({activeStepIndex:o.activeStepIndex,totalSteps:o.totalSteps,submitHandler:d,onNextStep:l,onPreviousStep:s,validators:c},a)))})),{stepsComponent:e,buttonsListComponent:n}}(),p=j.stepsComponent,O=j.buttonsListComponent;return Object(ae.jsxs)("div",{children:[p,O]})};ge.displayName="Wizard";var ye,Se=ge,ke=["activeStepIndex","children","direction"],Ce=Q.a.div(ye||(ye=Object(M.a)(["\n  position: relative;\n  height: 344px;\n"]))),we=function(e){Object(r.useEffect)((function(){var t=[];r.Children.forEach(e.children,(function(e){e.props.title&&t.push({title:e.props.title})})),e.updateStepTabs(t)}),[]);return Object(ae.jsx)(Ce,{children:function(){var t=e.activeStepIndex,n=e.children,a=e.direction,c=Object(Oe.a)(e,ke),i=[];return r.Children.map(n,(function(e,n){return e.props.title&&i.push({title:e.props.title}),Object(r.cloneElement)(e,{isActive:n===t,formik:c,direction:a})}))}()})};we.displayName="StepsList";var Ee=we,Re=n(193),Te=["isActive","component","direction"],Le=function(e,t){return 300*e*t},Ie=function(e){var t=e.isActive,n=e.component,r=e.direction,a=Object(Oe.a)(e,Te),c=0===r?50:-20;return Object(Re.useTransition)(t,{enter:{x:0,y:0,opacity:1},from:{x:Le(r,1),y:c,opacity:0},leave:{x:Le(r,-1),y:c,opacity:0}})((function(e,t){return t?Object(ae.jsxs)(Re.animated.div,{style:Object(ee.a)({position:"absolute"},e),children:[Object(ae.jsx)(oe.a.Title,{level:3,children:null===n||void 0===n?void 0:n.title}),n(a)]}):Object(ae.jsx)(ae.Fragment,{})}))};Ie.displayName="Step";var Fe=Ie,Ue=n(392),Ae=["children","type","show","onClick","label","validator"],Ne=function(e){var t,n=e.children,c=e.type,i=e.show,o=e.onClick,u=e.label,s=e.validator,l=Object(Oe.a)(e,Ae),d=s&&(null===(t=s.call(null))||void 0===t?void 0:t.errorMsgs)||[],b=Object(r.useState)(!1),j=Object(D.a)(b,2),p=j[0],O=j[1],f="function"===typeof s&&d.length>0;return i?n?a.a.cloneElement(n,{onClick:!s||s.call(null)?o:null,disabled:"function"===typeof s&&!s.call(null)}):Object(ae.jsx)(P.a,{title:d&&Object(ae.jsx)("span",{children:null===d||void 0===d?void 0:d[0]}),color:Z.error,visible:p,onVisibleChange:function(e){return O(e&&f)},children:Object(ae.jsx)(le.a,Object(ee.a)(Object(ee.a)({disabled:f,type:c,onClick:!s||s.call(null)?o:null},l),{},{children:u||"Next"}))}):null};Ne.defaultProps={type:"button"},Ne.displayName="WizardButton";var Ve,Be=Ne,_e=["activeStepIndex","totalSteps","onPreviousStep","onNextStep","onSubmit","children","validators"],De=Q.a.div(Ve||(Ve=Object(M.a)(["\n  display: flex;\n  justify-content: flex-end;\n  margin-top: 24px;\n"]))),Me=function(e){var t=e.activeStepIndex,n=e.totalSteps,a=e.onPreviousStep,c=e.onNextStep,i=(e.onSubmit,e.children),o=e.validators,u=Object(Oe.a)(e,_e);return Object(ae.jsx)(De,{children:r.Children.map(i,(function(e){var r=o[t];return"PreviousButton"===e.type.displayName?Object(ae.jsx)(Be,Object(ee.a)({type:"link",show:t>0,onClick:a,label:"\u4e0a\u4e00\u6b65"},e.props)):"NextButton"===e.type.displayName?Object(ae.jsx)(Be,Object(ee.a)({type:"primary",show:t<n,onClick:c,validator:r,label:"\u4e0b\u4e00\u6b65"},e.props)):"SubmitButton"===e.type.displayName?Object(ae.jsx)(Be,Object(ee.a)({show:t===n,onClick:u.submitHandler,validator:r,type:"primary",label:Object(ae.jsxs)("span",{children:[Object(ae.jsx)(Ue.a,{})," \u9001\u51fa"]})},e.props)):e}))})};Me.displayName="ButtonsList";var Qe=Me,Pe=function(){return null};Pe.displayName="PreviousButton";var ze=Pe,qe=function(){return null};qe.displayName="NextButton";var Ge=qe,He=function(){return null};He.displayName="SubmitButton";var Ke=He,We=["components","initialValues","validationSchema","onSubmit"];var Je=function(e){var t=e.components,n=e.initialValues,r=(e.validationSchema,e.onSubmit),a=Object(Oe.a)(e,We);return Object(ae.jsx)(fe.e,{initialValues:n,children:function(e){var c;return Object(ae.jsxs)(Se,Object(ee.a)(Object(ee.a)(Object(ee.a)({onSubmit:r,initialValues:n},e),a),{},{children:[Object(ae.jsx)(Ee,{validators:(c=t.map((function(e){return e.validate||function(){return!0}})),c.map((function(t){return function(){return t(Object(ee.a)({},e))}}))),children:t.map((function(e){return Object(ae.jsx)(Fe,{component:e},e.title)}))}),Object(ae.jsxs)(Qe,Object(ee.a)(Object(ee.a)({},e),{},{children:[Object(ae.jsx)(ze,{}),Object(ae.jsx)(Ge,{}),Object(ae.jsx)(Ke,{})]}))]}))}})},Ye=n(386),Xe=function(e,t){return te(e,{filter:Object($.a)({},t,!0)}).map((function(e){return Object(D.a)(e,1)[0]}))},Ze=function(e,t){t.forEach((function(t){var n=t.keys,r=t.action,a=new Set(n);Object.entries(e.participants).forEach((function(t){var n=Object(D.a)(t,2),c=n[0],i=n[1],o=a.has(c);i[r]!==o&&(e.participants[c][r]=o)}))}))},$e=function(e){var t=e.formik,n=t.values.participants;return Object(ae.jsx)(ae.Fragment,{children:Object(ae.jsx)(Ye.a,{dataSource:Object.values(n),titles:["\u672a\u8a02\u9910","\u6709\u8981\u8a02\u9910"],targetKeys:Xe(n,"targeted"),selectedKeys:Xe(n,"selected"),onChange:function(e){t.setValues(Object(he.a)(t.values,(function(t){Ze(t,[{keys:[],action:"selected"},{keys:e,action:"targeted"}])})))},onSelectChange:function(e,n){var r=[].concat(Object(_.a)(e),Object(_.a)(n));t.setValues(Object(he.a)(t.values,(function(e){Ze(e,[{keys:r,action:"selected"}])})))},render:function(e){return e.name}})})};$e.validate=function(e){var t={},n=[],r=e.values.participants;return te(r).length<2&&n.push("\u81f3\u5c11\u9700\u9078\u53d62\u500b\u8a02\u9910\u4eba"),n.length>0&&(t.errorMsgs=n),t},$e.title="\u8acb\u9078\u64c7\u53c3\u8207\u8a02\u9910\u4eba";var et,tt,nt,rt=$e,at=oe.a.Text,ct=Q.a.div(et||(et=Object(M.a)(["\n  width: ","px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n  & > * {\n    display: flex;\n  }\n"])),(function(e){return e.width})),it=function(e){var t=e.text,n=void 0===t?"":t,r=e.width,a=void 0===r?275:r,c=e.children;return Object(ae.jsxs)(ct,{width:a,children:[""===n?Object(ae.jsx)(ae.Fragment,{}):Object(ae.jsx)(at,{children:n}),c]})},ot=["type"],ut=Object(Q.a)(fe.b)(tt||(tt=Object(M.a)(["\n  outline: none;\n  cursor: pointer;\n  width: 155px;\n  height: 36px;\n  border-radius: 2px;\n  border: 1px\n    ","\n    solid;\n  padding-left: 4px;\n  font-size: ","px;\n  transition: 0.2s ease-in-out;\n  &:hover {\n    border: 1px "," solid;\n    background-color: ",";\n  }\n  /* &:focus {\n    background-color: ",";\n    border: 1px "," solid;\n  } */\n  ::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n  ::-webkit-outer-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n"])),(function(e){var t=e.errors,n=e.touched;return t&&n?"red":Z.getGray(.2)}),(function(e){return e.fontSize}),Z.getGray(.25),Z.getGray(.15),Z.white,Z.primaryBackgroundLight),st=function(e){var t=e.type,n=void 0===t?"number":t,r=Object(Oe.a)(e,ot);return Object(ae.jsx)(ut,Object(ee.a)({type:n},r))},lt=(Object(Q.a)(oe.a.Text)(nt||(nt=Object(M.a)(["\n  font-size: ","px;\n"])),(function(e){return null===e||void 0===e?void 0:e.size})),["text","width"]),dt=function(e){var t=e.text,n=e.width,r=Object(Oe.a)(e,lt);return Object(ae.jsx)(it,{text:t,width:n,children:Object(ae.jsx)(st,Object(ee.a)({},r))})},bt=function(e){var t=e.formik,n=t.values.participants;return Object(ae.jsx)(ae.Fragment,{children:te(n).map((function(e){var n,r,a,c,i,o=Object(D.a)(e,1)[0];return Object(ae.jsx)(dt,{name:"participants[".concat(o,"].cost"),text:o,value:null===t||void 0===t||null===(n=t.values)||void 0===n||null===(r=n.participants)||void 0===r||null===(a=r[o])||void 0===a?void 0:a.cost,onChange:t.handleChange,onBlur:t.handleBlur,touched:null===t||void 0===t||null===(c=t.touched)||void 0===c||null===(i=c.participants)||void 0===i?void 0:i[o],errors:t.errors[o],placeholder:"enter somthing"},o)}))})};bt.validate=function(e){var t={},n=[],r=e.values.participants;return te(r,{filter:{targeted:!0,cost:""}}).length>0&&n.push("\u9700\u586b\u5beb\u6240\u6709\u8a02\u9910\u4eba\u91d1\u984d\u3002\u82e5\u6c92\u6709\u8a02\u9910\u8acb\u56de\u4e0a\u4e00\u6b65\u79fb\u9664\u8a02\u9910\u4eba\u3002"),n.length>0&&(t.errorMsgs=n),t},bt.title="\u8acb\u8f38\u5165\u8a02\u9910\u91d1\u984d";var jt=bt,pt=n(171),Ot=n(389),ft=function(e){var t=e.formik,n=t.values,r=n.participants,a=n.payer;return Object(ae.jsx)(ae.Fragment,{children:Object(ae.jsx)(pt.a.Group,{buttonStyle:"solid",value:a,onChange:function(e){t.setValues(Object(he.a)(t.values,(function(t){t.payer=e.target.value})))},children:Object(ae.jsx)(Ot.b,{direction:"vertical",children:te(r).map((function(e){var t=Object(D.a)(e,1)[0];return Object(ae.jsx)(pt.a.Button,{value:t,children:t},t)}))})})})};ft.validate=function(e){var t={},n=[],r=e.values,a=r.payer,c=r.participants;return a&&c[a].targeted||n.push("\u8acb\u9078\u64c7\u4ed8\u6b3e\u4eba"),n.length>0&&(t.errorMsgs=n),t},ft.title="\u8acb\u9078\u64c7\u4ed8\u6b3e\u4eba";var vt=ft,ht=function(e){var t=e.formik,n=t.values,r=n.delivery,a=n.discount,c=n.note;return Object(ae.jsxs)("div",{children:[Object(ae.jsx)(dt,{text:"\u904b\u8cbb",value:(null===r||void 0===r?void 0:r.fee)||"",onChange:function(e){var n=e.target.value,r=""===n?n:+n;t.setValues(Object(he.a)(t.values,(function(e){e.delivery.fee=r})))},placeholder:"\u8acb\u8f38\u5165\u904b\u8cbb"}),Object(ae.jsx)(dt,{text:"\u512a\u60e0",value:(null===a||void 0===a?void 0:a.amount)||"",onChange:function(e){var n=e.target.value,r=""===n?n:+n;t.setValues(Object(he.a)(t.values,(function(e){e.discount.amount=r})))},placeholder:"\u8acb\u8f38\u5165\u512a\u60e0"}),Object(ae.jsx)(dt,{type:"text",text:"\u5099\u8a3b",value:c||"",onChange:function(e){var n=e.target.value;t.setValues(Object(he.a)(t.values,(function(e){e.note=n})))}})]})};ht.title="\u5176\u4ed6\u9078\u9805";var xt=ht,mt=n(393),gt=function(e){var t=e.formik.values,n=function(e){var t=e.delivery.fee,n=void 0===t?0:t,r=e.discount.amount,a=void 0===r?0:r,c=e.participants,i=void 0===c?{}:c,o=e.payer,u=void 0===o?"":o,s=te(i),l=s.reduce((function(e,t){var n=Object(D.a)(t,2);return n[0],e+n[1].cost}),0),d=s.length,b=n-a,j=re(b/d),p=[{title:"\u8a02\u9910\u4eba",dataIndex:"name",key:"name",render:function(e){return Object(ae.jsx)(P.a,{title:u===e?"\u4ed8\u6b3e\u4eba":null,children:Object(ae.jsxs)(oe.a.Text,{strong:!0,children:[u===e&&Object(ae.jsx)(mt.a,{twoToneColor:Z.mark}),e]})})}},{title:"\u91d1\u984d",dataIndex:"cost",key:"cost",render:function(e){return Object(ae.jsx)(P.a,{title:"".concat(e," ").concat(j>=0?"+":"-"," ").concat(Math.abs(j)),children:Object(ae.jsx)(oe.a.Link,{target:"_blank",children:re(e+j)})})}}],O=s.map((function(e){var t=Object(D.a)(e,2),n=t[0];return{key:n,name:n,cost:t[1].cost}}));return{discountAmount:a,totalAmount:l,deliveryFee:n,totalSharedFee:b,participantCount:d,sharedFee:j,dataSource:O,columns:p}}(t),r=n.discountAmount,a=n.deliveryFee,c=n.totalAmount,i=n.totalSharedFee,o=n.participantCount,u=n.sharedFee,s=n.dataSource,l=n.columns,d=t.note;return Object(ae.jsxs)(ae.Fragment,{children:[Object(ae.jsxs)(oe.a.Text,{strong:!0,children:[u<0?"\u5171\u4eab\u512a\u60e0":"\u5171\u540c\u5206\u64d4","\uff1a"]}),Object(ae.jsx)(P.a,{title:"\u904b\u8cbb\uff1a".concat(a,"\uff0c\u512a\u60e0\uff1a").concat(r),children:Object(ae.jsx)(oe.a.Link,{target:"_blank",children:Math.abs(i)})})," ","\xf7 ",o," = ",Math.abs(u),Object(ae.jsx)("br",{}),Object(ae.jsx)(oe.a.Text,{strong:!0,children:"\u5099\u8a3b\uff1a"}),d||Object(ae.jsx)(oe.a.Text,{type:"secondary",children:"\u7121\u5099\u8a3b"}),Object(ae.jsx)(B.a,{scroll:{y:300},size:"small",pagination:!1,columns:l,dataSource:s,summary:function(){return Object(ae.jsx)(B.a.Summary,{fixed:!0,children:Object(ae.jsxs)(B.a.Summary.Row,{children:[Object(ae.jsx)(B.a.Summary.Cell,{index:0,children:"\u7e3d\u984d"}),Object(ae.jsx)(B.a.Summary.Cell,{index:1,children:c+i})]})})}})]})};gt.title="\u7d50\u679c\u9810\u89bd";var yt,St,kt,Ct=[rt,jt,vt,xt,gt],wt=function(e){var t=e.initialValues,n=e.button,r=e.buttonTitle,a=void 0===r?"\u65b0\u589e\u4e00\u7b46\u8a18\u9304":r,c=e.onSubmit;return Object(ae.jsx)(pe,{button:n,buttonTitle:a,children:Object(ae.jsx)(Je,{initialValues:t,components:Ct,onSubmit:c})})},Et=n(33),Rt=n.n(Et),Tt=n(113),Lt=n(391),It=["children","popconfirmTitle","onConfirm"],Ft=function(e){var t=e.children,n=e.popconfirmTitle,a=void 0===n?"title":n,c=e.onConfirm,i=Object(Oe.a)(e,It),o=Object(r.useState)(!1),u=Object(D.a)(o,2),s=u[0],l=u[1],d=Object(r.useState)(!1),b=Object(D.a)(d,2),j=b[0],p=b[1];Object(r.useEffect)((function(){return function(){l(null),p(null)}}),[]);var O=function(){l(!0)},f=function(){var e=Object(Tt.a)(Rt.a.mark((function e(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.next=3,c();case 3:l(!1),p(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(ae.jsx)(ae.Fragment,{children:Object(ae.jsx)(Lt.a,{title:a,visible:s,onConfirm:f,okButtonProps:{loading:j},onCancel:function(){l(!1)},onVisibleChange:function(e){e||l(!1)},children:r.Children.map(t,(function(e){return Object(r.cloneElement)(e,Object(ee.a)({onClick:O},i))}))})})},Ut=["children"],At=Q.a.button(yt||(yt=Object(M.a)(["\n  outline: none;\n  border: none;\n  background-color: transparent;\n  box-shadow: rgba(99, 99, 99, 0.2) 0px 0px 8px 0px;\n  cursor: pointer;\n  margin: 20px;\n  border-radius: 4px;\n  transition: 1.9s cubic-bezier(0.075, 0.82, 0.165, 1);\n  margin: 4px;\n  &:hover {\n    box-shadow: rgba(20, 20, 20, 0.4) 0px 0px 13px 2px;\n  }\n  &:active {\n    box-shadow: rgba(99, 99, 99, 0.2) 0px 0px 4px 0px;\n    background-color: rgba(99, 99, 99, 0.2);\n  }\n"]))),Nt=function(e){var t=e.children,n=Object(Oe.a)(e,Ut);return Object(ae.jsx)(At,Object(ee.a)(Object(ee.a)({},n),{},{children:t}))},Vt=oe.a.Text,Bt=oe.a.Link,_t=function(e,t,n){var r=e.participants,a=(e.payer,e.delivery),c=e.discount,i=e.note,o=e.id,u=(null===a||void 0===a?void 0:a.fee)||0,s=(null===c||void 0===c?void 0:c.amount)||0,l=s-u,d=Object.entries(r).map((function(e){var t=Object(D.a)(e,2),n=t[0],r=t[1],a=r.cost;return{name:n,cost:r.targeted?a:Object(ae.jsx)(Vt,{type:"secondary",children:"\u7121\u53c3\u52a0"})}})).reduce((function(e,t){var n=t.name,r=t.cost;return Object(ee.a)(Object(ee.a)({},e),Object($.a)({},n,r))}),{});return Object(ee.a)(Object(ee.a)({key:"".concat(t+1),date:e,sharingFee:Object(ae.jsx)(P.a,{title:Object(ae.jsxs)("div",{children:[Object(ae.jsxs)("p",{style:{color:K.d[1],margin:0},children:["\u904b\u8cbb\uff1a",u]}),Object(ae.jsxs)("p",{style:{color:K.b[1],margin:0},children:["\u512a\u60e0\uff1a",s]})]}),children:Object(ae.jsx)(Bt,{children:l})}),payer:e,discountAmount:s},d),{},{deliveryFee:u,totalAmount:te(r).reduce((function(e,t){var n=Object(D.a)(t,2),r=(n[0],n[1].cost);return e+(void 0===r?0:r)}),u-s),note:i,action:Object(ae.jsxs)("div",{children:[Object(ae.jsx)(wt,{initialValues:e,button:Object(ae.jsx)(P.a,{title:"\u7de8\u8f2f\u6b64\u7b46\u8a18\u9304",placement:"bottomLeft",children:Object(ae.jsx)(Nt,{children:Object(ae.jsx)(ue.a,{twoToneColor:K.b[5]})})}),onSubmit:function(e){n(L({recordId:e.id,updatedRecord:e}))},children:"Update"}),Object(ae.jsx)(Ft,{popconfirmTitle:"\u5373\u5c07\u522a\u9664\u6b64\u7b46\u8a18\u9304",onConfirm:function(){return n(I({removingId:o}))},children:Object(ae.jsx)(P.a,{title:"\u522a\u9664\u6b64\u7b46\u8a18\u9304",placement:"bottomLeft",children:Object(ae.jsx)(Nt,{children:Object(ae.jsx)(se.a,{twoToneColor:K.d[5]})})})})]})})},Dt=(oe.a.Text,oe.a.Link,function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.records})),n=t.data,r=t.loading,a=ie(n),c=function(e,t){return e.map((function(e,n){return e.type,_t(e,n,t)}))}(n,e);return Object(ae.jsx)(V.a,{spinning:r,children:Object(ae.jsx)(B.a,{dataSource:c,columns:a,scroll:{x:1e3},pagination:{pageSize:4}})})}),Mt=n(196),Qt=n(137),Pt=Object(Q.a)(le.a)(St||(St=Object(M.a)(["\n"]))),zt=function(e){return Object(ae.jsx)(Pt,Object(ee.a)(Object(ee.a)({},e),{},{children:e.children}))},qt=Qt.a.Option,Gt=Q.a.div(kt||(kt=Object(M.a)(["\n  margin-top: 24px;\n"]))),Ht=function(){var e=Object(o.c)((function(e){return(null===e||void 0===e?void 0:e.users)||{}})).data,t=Object(o.b)();return Object(ae.jsx)(pe,{buttonTitle:"\u65b0\u589e\u4f7f\u7528\u8005",title:"\u65b0\u589e\u4f7f\u7528\u8005",children:Object(ae.jsx)(fe.e,{initialValues:{userName:""},validationSchema:function(){return Mt.a().shape({userName:Mt.b().required("\u5fc5\u9808\u586b\u5beb\u4f7f\u7528\u8005\u540d\u7a31")})},children:function(n){var r=n.values.userName;return Object(ae.jsxs)(fe.d,{children:[Object(ae.jsxs)(Gt,{children:[Object(ae.jsx)(dt,{type:"text",text:"\u4f7f\u7528\u8005\u540d\u7a31",name:"userName",onChange:n.handleChange,onBlur:n.handleBlur}),Object(ae.jsx)(fe.a,{name:"userName"})]}),Object(ae.jsx)(Gt,{children:Object(ae.jsx)(Qt.a,{style:{width:150},children:Object.entries(e).map((function(e){var t=Object(D.a)(e,1)[0];return Object(ae.jsx)(qt,{children:t},t)}))})}),Object(ae.jsx)(Gt,{children:Object(ae.jsx)(zt,{type:"primary",onClick:function(){t(N({userName:r}))},children:"\u65b0\u589e\u4f7f\u7528\u8005"})})]})}})})},Kt=function(){var e=Object(o.c)((function(e){var t;return(null===e||void 0===e||null===(t=e.users)||void 0===t?void 0:t.data)||{}})),t=ne(e),n=Object(o.b)();return Object(ae.jsx)(wt,{initialValues:t,buttonTitle:"\u65b0\u589e\u4e00\u7b46\u8cc7\u6599",onSubmit:function(e){n(T(e))}})},Wt=["text","fast","children"],Jt=function(e){var t=e.text,n=e.fast,r=e.children,a=Object(Oe.a)(e,Wt);return Object(ae.jsx)(it,{text:t,children:n?Object(ae.jsx)(fe.b,Object(ee.a)(Object(ee.a)({},a),{},{children:r})):Object(ae.jsx)(fe.c,Object(ee.a)(Object(ee.a)({},a),{},{children:r}))})},Yt=["text","name","validate","fast","children","onChange","onBlur"],Xt=function(e){var t=e.text,n=e.name,r=e.validate,a=e.fast,c=e.children,i=e.onChange,o=e.onBlur,u=Object(Oe.a)(e,Yt);return Object(ae.jsx)(Jt,{text:t,name:n,validate:r,fast:a,children:function(e){var t=e.field.value,r=e.form,a=r.setFieldValue,s=r.setFieldTouched;return Object(ae.jsx)(Qt.a,Object(ee.a)(Object(ee.a)({onChange:function(e,t){a(n,e),i&&i(e,t)},onBlur:function(e){s(n),o&&o(e)},value:""===t||null===t?void 0:t},u),{},{children:c}))}})};Xt.Option=Qt.a.Option;var Zt=Xt,$t=Zt.Option,en=function(e){var t=e.formik.values,n=t.participants,r=t.payer,a=t.payee,c=t.transferAmount;return Object(ae.jsxs)(ae.Fragment,{children:[Object(ae.jsx)(Zt,{name:"payer",text:"\u4ed8\u6b3e\u4eba",showSearch:!0,style:{width:155},placeholder:"Select a person",optionFilterProp:"children",filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},children:Object.keys(n).map((function(e){return Object(ae.jsx)($t,{value:e,disabled:a===e,children:e},e)}))}),Object(ae.jsx)(Zt,{name:"payee",text:"\u6536\u6b3e\u4eba",showSearch:!0,style:{width:155},placeholder:"Select a person",optionFilterProp:"children",filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},children:Object.keys(n).map((function(e){return Object(ae.jsx)($t,{value:e,disabled:r===e,children:e},e)}))}),Object(ae.jsx)(dt,{text:"\u91d1\u984d",value:c,name:"transferAmount",placeholder:"\u8acb\u8f38\u5165\u91d1\u984d"})]})};en.validate=function(e){var t={},n=[],r=e.values,a=r.transferAmount,c=r.payer,i=r.payee;return a||n.push("\u8acb\u8f38\u5165\u91d1\u984d"),c||n.push("\u8acb\u9078\u64c7\u4ed8\u6b3e\u4eba"),i||n.push("\u8acb\u9078\u64c7\u6536\u6b3e\u4eba"),n.length>0&&(t.errorMsgs=n),t},en.title="\u8acb\u586b\u5beb\u8f49\u9322\u8cc7\u8a0a";var tn=[en],nn=function(e){var t=e.loading,n=e.initialValues,r=e.button,a=e.buttonTitle,c=void 0===a?"\u8f49\u9322":a,i=e.onSubmit,o=function(e){return{participants:e.participants,payer:"",payee:"",transferAmount:""}}(n);return Object(ae.jsx)(pe,{loading:t,button:r,buttonTitle:c,children:Object(ae.jsx)(Je,{initialValues:o,components:tn,onSubmit:i})})},rn=function(){var e=Object(o.c)((function(e){return(null===e||void 0===e?void 0:e.users)||{}})),t=e.data,n=void 0===t?{}:t,r=e.loading,a=Object(ee.a)(Object(ee.a)({},ne(n)),{},{type:"TRANSFER_MONEY"}),c=Object(o.b)();return Object(ae.jsx)(nn,{initialValues:a,buttonTitle:"\u8f49\u9322",loading:r,onSubmit:function(e){var t=e.payer,n=e.payee,r=e.transferAmount,i=Object(he.a)(a,(function(e){Object.entries(e.participants).forEach((function(e){var r=Object(D.a)(e,2),a=r[0],c=r[1];a!==n&&a!==t&&(c.targeted=!1)})),e.participants[n].cost=r,e.participants[t].cost=0,e.payer=t,e.note="".concat(t,"\u8f49\u7d66").concat(n," ").concat(r,"\u5143")}));console.log(i),c(T(i))}})},an=function(){return Object(ae.jsxs)("div",{style:{display:"flex",height:"100%",alignItems:"center",justifyContent:"flex-end"},children:[Object(ae.jsx)(rn,{}),Object(ae.jsx)(Ht,{}),Object(ae.jsx)(Kt,{})]})},cn=u.a.Header,on=u.a.Content,un=u.a.Footer,sn=(u.a.Sider,function(){var e=Object(o.b)();return Object(r.useEffect)((function(){e(R()),e(A())}),[e]),Object(ae.jsx)(ae.Fragment,{children:Object(ae.jsxs)(u.a,{className:"site-layout",children:[Object(ae.jsx)(cn,{className:"site-layout-background",style:{padding:0},children:Object(ae.jsx)(an,{})}),Object(ae.jsx)(u.a,{children:Object(ae.jsx)(on,{style:{margin:16,borderRadius:4},children:Object(ae.jsx)(Dt,{})})}),Object(ae.jsx)(un,{style:{textAlign:"center"},children:Object(ae.jsx)(s.a,{offsetBottom:10,children:Object(ae.jsxs)("div",{children:[O?Object(ae.jsxs)("p",{children:["\u60a8\u73fe\u5728\u4f7f\u7528\u7684\u662f\u96e2\u7dda\u7248\u672c\u7684Let's go dutch! \uff0c\u5982\u679c\u60f3\u4f7f\u7528\u96f2\u7aef\u7248\u672c\u7684Let's go dutch! \uff0c\u53ef\u4ee5\u53c3\u8003",Object(ae.jsx)("a",{href:"https://github.com/RuChuanLin/letsgodutch#installation",children:"\u9019\u7bc7\u6559\u5b78"}),"\u3002"]}):null,Object(ae.jsxs)("p",{children:["\u5982\u679c\u60a8\u559c\u6b61\u9019\u500b\u5c08\u6848\uff0c\u8acb\u9f13\u52f5\u4f5c\u8005\u4e00\u500bGithub\u661f\u661f~",Object(ae.jsx)(l.a,{href:"https://github.com/RuChuanLin/letsgodutch","data-size":"large","aria-label":"Star RuChuanLin/letsgodutch on GitHub",children:"Star"})]})]})})})]})})}),ln=n(109),dn=function(e,t,n){switch(t.httpState){case"REQUEST":return Object(ee.a)(Object(ee.a)({},e),{},{loading:!0});case"SUCCESS":return Object(ee.a)(Object(ee.a)({},e),{},{data:n||t.data,loading:!1,error:null});case"FAILURE":return Object(ee.a)(Object(ee.a)({},e),{},{loading:!1,error:n||t.data,data:null});default:return e}},bn={data:[]},jn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k.REQUEST:case k.SUCCESS:case k.FAILURE:case C.REQUEST:case C.SUCCESS:case C.FAILURE:case w.REQUEST:case w.SUCCESS:case w.FAILURE:case E.REQUEST:case E.SUCCESS:case E.FAILURE:return dn(e,t);default:return e}},pn={},On=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case F.REQUEST:case F.SUCCESS:case F.FAILURE:case U.REQUEST:case U.SUCCESS:case U.FAILURE:return dn(e,t);default:return e}},fn=n(248),vn=n(243),hn=n(42),xn=n(179),mn=function(e){return(null===e||void 0===e?void 0:e.docs)?e.docs:e},gn=function(e){return(null===e||void 0===e?void 0:e.data)&&"function"===typeof e.data?e.data():e},yn=Rt.a.mark(Cn),Sn=Rt.a.mark(wn),kn=Rt.a.mark(En);function Cn(){var e,t,n;return Rt.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,y().get();case 3:return e=r.sent,t=mn(e),n=t.map(gn).reduce((function(e,t){return Object(ee.a)(Object(ee.a)({},e),{},Object($.a)({},t.name,{}))}),{}),r.next=8,Object(hn.b)(F.success(n));case 8:r.next=14;break;case 10:return r.prev=10,r.t0=r.catch(0),r.next=14,Object(hn.b)(F.failure(r.t0));case 14:case"end":return r.stop()}}),yn,null,[[0,10]])}function wn(e){var t,n,r,a,c;return Rt.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(t=e.data,!(n=t.userName)){i.next=19;break}return i.next=5,Object(hn.c)((function(e){var t;return null===e||void 0===e||null===(t=e.users)||void 0===t?void 0:t.data}));case 5:return r=i.sent,i.prev=6,a=Object(xn.a)(),c={name:n,date:(new q.a).valueOf(),id:a},i.next=11,y().doc(a).set(c);case 11:return i.next=13,Object(hn.b)(U.success(Object(he.a)(r,(function(e){e[n]=c}))));case 13:i.next=19;break;case 15:return i.prev=15,i.t0=i.catch(6),i.next=19,Object(hn.b)(U.failure(i.t0));case 19:case"end":return i.stop()}}),Sn,null,[[6,15]])}function En(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(hn.a)([Object(hn.d)(F.REQUEST,Cn),Object(hn.d)(U.REQUEST,wn)]);case 2:case"end":return e.stop()}}),kn)}var Rn=Rt.a.mark(Un),Tn=Rt.a.mark(An),Ln=Rt.a.mark(Nn),In=Rt.a.mark(Vn),Fn=Rt.a.mark(Bn);function Un(){var e,t,n;return Rt.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,g().orderBy("date","desc").get();case 3:return e=r.sent,t=mn(e),n=t.map((function(e){return Object(ee.a)(Object(ee.a)({},gn(e)),{},{id:e.id})})),r.next=8,Object(hn.b)(k.success(n));case 8:r.next=14;break;case 10:return r.prev=10,r.t0=r.catch(0),r.next=14,Object(hn.b)(k.failure(r.t0));case 14:case"end":return r.stop()}}),Rn,null,[[0,10]])}function An(e){var t,n,r,a;return Rt.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(t=e.data){c.next=3;break}return c.abrupt("return");case 3:return n=Object(xn.a)(),r=Object(ee.a)(Object(ee.a)({},t),{},{date:(new q.a).valueOf(),id:n}),c.prev=5,c.next=8,g().doc(n).set(r);case 8:return c.next=10,Object(hn.c)((function(e){var t;return(null===e||void 0===e||null===(t=e.records)||void 0===t?void 0:t.data)||[]}));case 10:return a=c.sent,c.next=13,Object(hn.b)(C.success([r].concat(Object(_.a)(a))));case 13:c.next=19;break;case 15:return c.prev=15,c.t0=c.catch(5),c.next=19,Object(hn.b)(C.failure(c.t0));case 19:case"end":return c.stop()}}),Tn,null,[[5,15]])}function Nn(e){var t,n,r,a;return Rt.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.data,n=t.recordId,r=t.updatedRecord,c.next=4,Object(hn.c)((function(e){var t;return(null===e||void 0===e||null===(t=e.records)||void 0===t?void 0:t.data)||[]}));case 4:return a=c.sent,c.prev=5,c.next=8,g().doc(n).set(r);case 8:return c.next=10,Object(hn.b)(w.success(a.map((function(e){return e.id===n?r:e}))));case 10:c.next=14;break;case 12:c.prev=12,c.t0=c.catch(5);case 14:case"end":return c.stop()}}),Ln,null,[[5,12]])}function Vn(e){var t,n,r;return Rt.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.data,n=t.removingId,a.next=4,Object(hn.c)((function(e){var t;return(null===e||void 0===e||null===(t=e.records)||void 0===t?void 0:t.data)||[]}));case 4:return r=a.sent,a.prev=5,a.next=8,g().doc(n).delete();case 8:return a.next=10,Object(hn.b)(E.success(r.filter((function(e){return e.id!==n}))));case 10:a.next=15;break;case 12:a.prev=12,a.t0=a.catch(5),console.log(a.t0);case 15:case"end":return a.stop()}}),In,null,[[5,12]])}function Bn(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(hn.a)([Object(hn.d)(k.REQUEST,Un),Object(hn.d)(C.REQUEST,An),Object(hn.d)(w.REQUEST,Nn),Object(hn.d)(E.REQUEST,Vn)]);case 2:case"end":return e.stop()}}),Fn)}var _n=Rt.a.mark(Dn);function Dn(){return Rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(hn.a)([En(),Bn()]);case 2:case"end":return e.stop()}}),_n)}var Mn=Object(vn.createLogger)(),Qn=Object(fn.a)(),Pn=Object(ln.d)(Object(ln.b)({records:jn,users:On}),Object(ln.a)(Qn,Mn));Qn.run(Dn);var zn=Pn;i.a.render(Object(ae.jsx)(o.a,{store:zn,children:Object(ae.jsx)(sn,{})}),document.getElementById("root"))}},[[382,1,2]]]);
//# sourceMappingURL=main.29964b2a.chunk.js.map