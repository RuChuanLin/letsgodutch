{"version":3,"sources":["firebase/init.js","firebase/index.js","redux/utils/actionCreator.js","redux/record/action.js","redux/user/action.js","utils/colors.js","utils/common.js","containers/DataTable/functions/generateColumns.js","components/Modal.js","components/FormikWizard/Wizard.js","components/FormikWizard/StepsList.js","components/FormikWizard/Step.js","components/FormikWizard/Button.js","components/FormikWizard/ButtonsList.js","components/FormikWizard/PreviousButton.js","components/FormikWizard/NextButton.js","components/FormikWizard/SubmitButton.js","components/FormikWizard/index.js","containers/_common/CURDRecordModal/SelectParticipants.js","components/_wrapper/FieldWrapper.js","components/Input/Field.js","components/Text/index.js","components/Input/index.js","containers/_common/CURDRecordModal/RecordCost.js","containers/_common/CURDRecordModal/SelectPayer.js","containers/_common/CURDRecordModal/RecordOtherStuff.js","containers/_common/CURDRecordModal/ResultsPreview.js","containers/_common/CURDRecordModal/index.js","components/Popconfirm.js","components/IconButton/index.js","containers/DataTable/functions/genDefaultRecord.js","containers/DataTable/index.js","containers/DataTable/functions/genTranferMoneyRecord.js","components/Button/index.js","containers/Panel/AddUserModal.js","containers/Panel/AddNewRecordModal.js","components/FormikField/index.js","components/FormikSelect/index.js","containers/_common/TransferMoneyModal/RecordInfo.js","containers/_common/TransferMoneyModal/index.js","containers/Panel/TransferMoney.js","containers/Panel/index.js","App.js","redux/utils/reducerHandler.js","redux/record/reducer.js","redux/user/reducer.js","utils/dbApiUnification.js","redux/user/saga.js","redux/record/saga.js","redux/rootSaga.js","redux/store.js","index.js"],"names":["urlSearchParams","URLSearchParams","window","location","search","configs","Object","fromEntries","entries","usingLocalDB","db","apiKey","authDomain","projectId","firebase","initializeApp","firestore","e","Localbase","getRecordDB","collection","getUserDB","actionCreator","action","reduce","acc","value","type","toLowerCase","data","httpState","loadAllRecordsActions","addNewRecordActions","updateRecordActions","removeRecordActions","loadAllRecords","request","addNewRecord","updateRecord","removeRecord","loadAllUsersActions","addUserActions","loadAllUsers","addUser","primaryBackground","primaryBackgroundDark","chroma","darken","hex","primaryBackgroundLight","brighten","white","colors","mark","error","getGray","scale","getbalanceColor","balance","red","green","domain","filterParticipants","memoIniObject","memoFinishedObject","memoIniOptionsObject","participantObject","options","filter","targeted","participant","every","key","genNewRecordObject","memoInitUsers","memoFinishedNewRecord","users","delivery","fee","discount","amount","participants","keys","name","selected","cost","payer","fixNumber","number","fixDigit","nPowerOf10","Math","round","Number","EPSILON","BalanceSpan","styled","span","generateColumns","records","totalCostAmount","length","initValue","participantEntries","averageDeliveryFee","totalAmount","forEach","generateTotalCostAmount","map","title","render","children","style","background","dataIndex","width","sort","a","b","fixed","defaultSortOrder","sorter","date","sortDirections","$moment","moment","format","ellipsis","showTitle","note","StyledButton","Button","StyledModal","Modal","CustomModal","button","buttonTitle","okFunction","loading","useState","isModalVisible","setIsModalVisible","showModal","cloneElement","onClick","visible","onOk","onCancel","footer","centered","overflow","maxWidth","spinning","Children","child","getTotalSteps","reactChildren","React","toArray","displayName","props","Error","Wizard","onSubmit","activeStepIndex","totalSteps","stepTabs","direction","state","setState","onPreviousStep","produce","draftState","onNextStep","submitHandler","values","setValues","initialValues","draft","updateStepTabs","stepsComponent","buttonsListComponent","validators","getInitialComponents","Wrapper","div","StepsList","useEffect","push","formik","index","isActive","getStepChildren","getX","actionPara","Step","component","y","useTransition","enter","x","opacity","from","leave","transition","item","position","Title","level","WizardButton","show","label","validator","errorMsgs","call","tooltipVisible","setTooltipVisible","disabledNext","disabled","color","onVisibleChange","defaultProps","ButtonsList","RocketOutlined","PreviousButton","NextButton","SubmitButton","App","components","validationSchema","validatorFuncs","validate","func","c","filterObject","filterKey","participantChangeHandler","keySet","Set","obj","included","has","SelectParticipants","dataSource","titles","targetKeys","selectedKeys","onChange","nextTargetKeys","onSelectChange","sourceSelectedKeys","targetSelectedKeys","errors","Text","Typography","FieldWrapper","text","StyledFastField","FastField","touched","fontSize","Field","size","InputItem","RecordCost","Input","handleChange","onBlur","handleBlur","placeholder","SelectPayer","Group","buttonStyle","target","ResultsPreview","deliveryFee","discountAmount","filteredParticipants","participantCount","totalSharedFee","sharedFee","columns","strong","CrownTwoTone","twoToneColor","abs","Link","arrangeValues","scroll","pagination","summary","Summary","Row","Cell","RecordOtherStuff","CURDRecordModal","FormikWizard","_Popconfirm","popconfirmTitle","onConfirm","setVisible","confirmLoading","setConfirmLoading","showPopconfirm","handleOk","okButtonProps","IconButton","genDefaultRecord","record","dispatch","id","sharingFee","arrangedParticipants","volcano","margin","placement","EditTwoTone","recordId","updatedRecord","Popconfirm","removingId","DeleteTwoTone","DataTable","useDispatch","useSelector","i","generateDataSource","pageSize","_Button","Option","Select","AddUserModal","userName","yup","shape","required","AddNewRecordModal","initNewRecord","FormikField","fast","restProps","FormikSelect","field","form","setFieldValue","setFieldTouched","option","undefined","payee","transferAmount","showSearch","optionFilterProp","filterOption","input","indexOf","TransferMoneyModal","addNecessaryAttributions","TransferMoney","userObject","initNewTransferRecord","resultRecord","console","log","Panel","display","height","alignItems","justifyContent","Header","Layout","Content","Footer","Sider","className","padding","borderRadius","textAlign","offsetBottom","href","reducerHandler","initialState","reducer","REQUEST","SUCCESS","FAILURE","snapshots2Docs","snapshots","docs","snapshot2Data","snapshot","recordSaga","get","cur","put","success","failure","select","nanoid","valueOf","doc","set","all","takeLatest","orderBy","allRecords","newRecord","arrangedRecord","delete","rootSaga","userSaga","loggerMiddleware","createLogger","sagaMiddleare","createSagaMiddleware","store","createStore","combineReducers","applyMiddleware","run","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.29964b2a.chunk.js","sourcesContent":["import firebase from \"firebase\";\r\nimport Localbase from \"localbase\";\r\nimport \"firebase/database\";\r\n// import configs from \"./configs\";\r\n\r\nconst urlSearchParams = new URLSearchParams(window.location.search);\r\nconst configs = Object.fromEntries(urlSearchParams.entries());\r\n\r\nlet usingLocalDB = false;\r\nlet db = null;\r\nif (configs.apiKey && configs.authDomain && configs.projectId) {\r\n  try {\r\n    firebase.initializeApp(configs);\r\n    db = firebase.firestore();\r\n  } catch (e) {\r\n    db = new Localbase(\"db\");\r\n  }\r\n} else {\r\n  usingLocalDB = true;\r\n  db = new Localbase(\"db\");\r\n}\r\n\r\nexport { usingLocalDB };\r\nexport default db;","import firebase from \"./init\";\r\n\r\nexport const getRecordDB = () => firebase.collection(\"records\");\r\nexport const getUserDB = () => firebase.collection(\"users\");\r\n","/*\r\n  Use this helper function to generate actions and types automatically\r\n  This will return a object generating 3 actions and 3 types:\r\n  {\r\n    FAILURE: \"GET_USERS_LIST_FAILURE\",\r\n    SUCCESS: \"GET_USERS_LIST_SUCCESS\",\r\n    REQUEST: \"GET_USERS_LIST_REQUEST\",\r\n    failure: payload => ({ type, payload, }), // type: GET_USERS_LIST_FAILURE\r\n    success: payload => ({ type, payload, }), // type: GET_USERS_LIST_SUCCESS\r\n    request: payload => ({ type, payload, }), // type: GET_USERS_LIST_REQUEST\r\n  }\r\n*/\r\nconst actionCreator = (action) => {\r\n  const values = [\"SUCCESS\", \"FAILURE\", \"REQUEST\"];\r\n  const types = values.reduce((acc, value) => {\r\n    const type = `${action}_${value}`;\r\n    acc[value] = type;\r\n    acc[value.toLowerCase()] = (data) => ({\r\n      type,\r\n      data,\r\n      httpState: value,\r\n    });\r\n    return acc;\r\n  }, {});\r\n  return types;\r\n};\r\n\r\nexport default actionCreator;\r\n","import { getRecordDB } from \"../../firebase\";\r\nimport actionCreator from \"../utils/actionCreator\";\r\n\r\nexport const loadAllRecordsActions = actionCreator(\"RECORDS__LOAD_ALL_RECORD\");\r\nexport const addNewRecordActions = actionCreator(\"RECORDS__ADD_RECORD\");\r\nexport const updateRecordActions = actionCreator(\"RECORDS__UPDATE_RECORD\");\r\nexport const removeRecordActions = actionCreator(\"RECORDS__REMOVE_RECORD\");\r\n\r\nexport const { request: loadAllRecords } = loadAllRecordsActions;\r\nexport const { request: addNewRecord } = addNewRecordActions;\r\nexport const { request: updateRecord } = updateRecordActions;\r\nexport const { request: removeRecord } = removeRecordActions;\r\n\r\n","import actionCreator from \"../utils/actionCreator\";\r\n\r\nexport const loadAllUsersActions = actionCreator(\"USER__LOAD_ALL_USERS\");\r\nexport const addUserActions = actionCreator(\"USER__ADD_USER\");\r\n\r\nexport const { request: loadAllUsers } = loadAllUsersActions;\r\nexport const { request: addUser } = addUserActions;\r\n","import chroma from \"chroma-js\";\r\nimport {red, green} from '@ant-design/colors'\r\n\r\nconst primaryBackground = \"#1890ff\";\r\nconst primaryBackgroundDark = chroma(primaryBackground).darken(0.3).hex();\r\nconst primaryBackgroundLight = chroma(primaryBackground).brighten(0.4).hex();\r\nconst mark = \"#C7802D\";\r\nconst error = \"#f50\";\r\nconst white = \"#FFFFFB\";\r\nconst black = \"#080808\";\r\nconst getGray = (scale) => chroma.scale([white, black])(scale).hex();\r\nconst getbalanceColor = (balance) =>\r\n  chroma.scale([red[2], \"#fff\", green[2]]).domain([-1000, 1000])(balance).hex();\r\n\r\nconst colors = {\r\n  primaryBackground,\r\n  primaryBackgroundDark,\r\n  primaryBackgroundLight,\r\n  mark,\r\n  error,\r\n  white,\r\n  getGray,\r\n  getbalanceColor\r\n};\r\n\r\nexport default colors;\r\n","/**\r\n * filter participants\r\n *\r\n * this project requires to filter out untargete or unselected participants frequently, so we need a independant funtion to deal with it.\r\n *\r\n * note: this function use a memorization to minimize the amount of calculation.\r\n */\r\nconst filterParticipants = (() => {\r\n  let [memoIniObject, memoFinishedObject] = [{}, []];\r\n  let [memoIniOptionsObject] = [{}];\r\n  return (\r\n    participantObject,\r\n    options = {\r\n      filter: { targeted: true },\r\n    }\r\n  ) => {\r\n    if (participantObject === memoIniObject && memoIniOptionsObject === options) {\r\n      return memoFinishedObject;\r\n    }\r\n    memoIniObject = participantObject;\r\n    memoIniOptionsObject = options;\r\n    memoFinishedObject = Object.entries(participantObject).filter((participant) =>\r\n      Object.entries(options.filter).every(([key, value]) => participant?.[1]?.[key] === value)\r\n    );\r\n    return memoFinishedObject;\r\n  };\r\n})();\r\n\r\nexport const genNewRecordObject = (() => {\r\n  let [memoInitUsers, memoFinishedNewRecord] = [{}, {}];\r\n  return (users) => {\r\n    if (users !== memoInitUsers) {\r\n      memoInitUsers = users;\r\n      memoFinishedNewRecord = {\r\n        delivery: {\r\n          fee: 0,\r\n        },\r\n        discount: {\r\n          amount: 0,\r\n        },\r\n        participants: Object.keys(users).reduce(\r\n          (acc, name) => ({\r\n            ...acc,\r\n            [name]: { key: name, name, targeted: true, selected: false, cost: \"\" },\r\n          }),\r\n          {}\r\n        ),\r\n        payer: \"\",\r\n      };\r\n    }\r\n    return memoFinishedNewRecord;\r\n  };\r\n})();\r\n\r\nconst fixNumber = (number, options = {}) => {\r\n  const { fixDigit = 2 } = options;\r\n  const nPowerOf10 = 10 ** fixDigit;\r\n  return Math.round((number + Number.EPSILON) * nPowerOf10) / nPowerOf10;\r\n};\r\nexport { filterParticipants, fixNumber };\r\n","import styled from \"styled-components\";\r\nimport { Tooltip } from \"antd\";\r\nimport moment from \"moment\";\r\nimport colors from \"../../../utils/colors\";\r\nimport { fixNumber, filterParticipants } from \"../../../utils/common\";\r\n\r\nconst BalanceSpan = styled.span`\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  justify-content: flex-start;\r\n  align-items: center;\r\n  padding-left: 16px;\r\n`;\r\n\r\nconst generateTotalCostAmount = (records) =>\r\n  records.reduce((acc, { participants, payer, delivery, discount }) => {\r\n    if (Object.keys(participants).length === 0) {\r\n      return acc;\r\n    }\r\n    const deliveryFee = delivery?.fee || 0;\r\n    const discountAmount = discount?.amount || 0;\r\n    const initValue = deliveryFee - discountAmount;\r\n    const participantEntries = filterParticipants(participants);\r\n    const averageDeliveryFee = initValue / participantEntries.length;\r\n    let totalAmount = initValue;\r\n    participantEntries.forEach(([name, { cost = 0 }]) => {\r\n      acc[name] = (acc[name] || 0) - cost - averageDeliveryFee;\r\n      totalAmount += cost;\r\n    });\r\n    acc[payer] += totalAmount;\r\n    return acc;\r\n  }, {});\r\n\r\nconst generateColumns = (records) => {\r\n  const totalCostAmount = generateTotalCostAmount(records);\r\n  const participants = Object.keys(totalCostAmount).map((participant) => {\r\n    const balance = fixNumber(totalCostAmount[participant]);\r\n    return {\r\n      title: participant,\r\n      render: (cost) => cost || 0,\r\n      children: [\r\n        {\r\n          title: (\r\n            <BalanceSpan style={{ background: colors.getbalanceColor(balance) }}>\r\n              {balance}\r\n            </BalanceSpan>\r\n          ),\r\n          dataIndex: participant,\r\n          key: participant,\r\n          width: 100,\r\n        },\r\n      ],\r\n      balance,\r\n    };\r\n  });\r\n  participants.sort((a, b) => a.balance - b.balance);\r\n  return [\r\n    {\r\n      title: \"日期\",\r\n      dataIndex: \"date\",\r\n      key: \"date\",\r\n      width: 80,\r\n      fixed: \"left\",\r\n      defaultSortOrder: \"descend\",\r\n      sorter: (a, b) => a.date.date - b.date.date,\r\n      sortDirections: [\"ascend\"],\r\n      render: ({ date }) => {\r\n        const $moment = moment(date);\r\n        return <Tooltip title={$moment.format(\"yyyy-M-D H:mm\")}>{$moment.format(\"M/D\")}</Tooltip>;\r\n      },\r\n    },\r\n    {\r\n      title: \"付款人\",\r\n      dataIndex: \"payer\",\r\n      key: \"payer\",\r\n      width: 100,\r\n      fixed: \"left\",\r\n      render: ({ payer }) => payer,\r\n    },\r\n    {\r\n      title: \"共享\",\r\n      dataIndex: \"sharingFee\",\r\n      key: \"sharingFee\",\r\n      width: 80,\r\n      fixed: \"left\",\r\n    },\r\n    ...participants,\r\n    { title: \"總額\", dataIndex: \"totalAmount\", key: \"totalAmount\", fixed: \"right\", width: 100 },\r\n    {\r\n      title: \"備註\",\r\n      dataIndex: \"note\",\r\n      key: \"note\",\r\n      ellipsis: {\r\n        showTitle: false,\r\n      },\r\n      render: (note) => <Tooltip title={note}>{note}</Tooltip>,\r\n      width: 175,\r\n      fixed: \"right\",\r\n    },\r\n    { title: \"Action\", dataIndex: \"action\", key: \"action\", width: 100, fixed: \"right\" },\r\n  ];\r\n};\r\n\r\nexport default generateColumns;\r\n","import React, { useState, Children, cloneElement } from \"react\";\r\nimport { Modal, Button, Spin } from \"antd\";\r\nimport styled from \"styled-components\";\r\n\r\nconst StyledButton = styled(Button)`\r\n  color: #eee;\r\n  margin-right: 8px;\r\n  height: 48px;\r\n  border-radius: 16px;\r\n  &:hover {\r\n    color: #fff;\r\n    background: rgba(255, 255, 255, 0.2);\r\n    box-shadow: rgba(255, 255, 255, 0.3) 0px 0px 8px 0px;\r\n  }\r\n  &:active {\r\n    color: #fff;\r\n    background: rgba(255, 255, 255, 0.1);\r\n    box-shadow: rgba(255, 255, 255, 0.7) 0px 0px 8px 4px;\r\n  }\r\n  &:focus {\r\n    color: #eee;\r\n  }\r\n`;\r\n\r\nconst StyledModal = styled(Modal)`\r\n  &::-webkit-scrollbar {\r\n    display: none;\r\n  }\r\n`;\r\n\r\nconst CustomModal = ({\r\n  button,\r\n  buttonTitle = \"Open Modal\",\r\n  okFunction,\r\n  loading = false,\r\n  children,\r\n}) => {\r\n  const [isModalVisible, setIsModalVisible] = useState(false);\r\n\r\n  const showModal = () => {\r\n    setIsModalVisible(true);\r\n  };\r\n\r\n  const handleOk = () => {\r\n    okFunction();\r\n    setIsModalVisible(false);\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setIsModalVisible(false);\r\n  };\r\n\r\n  const clonedChildren = () =>\r\n    Children.map(children, (child) =>\r\n      cloneElement(child, {\r\n        isModalVisible,\r\n        setIsModalVisible,\r\n      })\r\n    );\r\n\r\n  return (\r\n    <>\r\n      {button ? (\r\n        cloneElement(button, {\r\n          onClick: showModal,\r\n        })\r\n      ) : (\r\n        <StyledButton loading={loading} type=\"text\" onClick={showModal}>\r\n          {buttonTitle}\r\n        </StyledButton>\r\n      )}\r\n      <StyledModal\r\n        visible={isModalVisible}\r\n        onOk={handleOk}\r\n        onCancel={handleCancel}\r\n        footer={null}\r\n        centered\r\n        style={{ overflow: \"auto\", maxWidth: \"448px\" }}\r\n      >\r\n        <Spin spinning={loading}>{clonedChildren()}</Spin>\r\n      </StyledModal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CustomModal;\r\n","import React, { Children, cloneElement, useState } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n// import StepTabs from \"./StepTabs\";\r\nimport { produce } from \"immer\";\r\n\r\nconst getTotalSteps = (children) => {\r\n  const reactChildren = React.Children.toArray(children);\r\n  for (const child of reactChildren) {\r\n    if (child.type.displayName === \"StepsList\") {\r\n      return child.props.children.length - 1;\r\n    }\r\n  }\r\n  throw new Error(\"Require StepsList\");\r\n};\r\n\r\nconst Wizard = ({ children, onSubmit, ...props }) => {\r\n  const [state, setState] = useState({\r\n    activeStepIndex: 0,\r\n    totalSteps: getTotalSteps(children),\r\n    stepTabs: [],\r\n    direction: 0,\r\n  });\r\n\r\n  const onPreviousStep = () =>\r\n    setState(\r\n      produce(state, (draftState) => {\r\n        draftState.activeStepIndex = state.activeStepIndex - 1;\r\n        draftState.direction = -1;\r\n      })\r\n    );\r\n\r\n  const onNextStep = () =>\r\n    setState(\r\n      produce(state, (draftState) => {\r\n        draftState.activeStepIndex = state.activeStepIndex + 1;\r\n        draftState.direction = 1;\r\n      })\r\n    );\r\n\r\n  const submitHandler = onSubmit\r\n    ? () => {\r\n        onSubmit(props.values);\r\n        props.setIsModalVisible(false);\r\n        props.setValues(props.initialValues);\r\n        setState(\r\n          produce(state, (draft) => {\r\n            draft.activeStepIndex = 0;\r\n            draft.direction = 0;\r\n          })\r\n        );\r\n      }\r\n    : () => {};\r\n\r\n  const updateStepTabs = (stepTabs) =>\r\n    setState(\r\n      produce(state, (draftState) => {\r\n        draftState.stepTabs = stepTabs;\r\n      })\r\n    );\r\n\r\n  const getInitialComponents = () => {\r\n    let stepsComponent = null;\r\n    let buttonsListComponent = null;\r\n    let validators = [];\r\n\r\n    Children.forEach(children, (child) => {\r\n      if (child.type.displayName === \"StepsList\") {\r\n        stepsComponent = cloneElement(child, {\r\n          activeStepIndex: state.activeStepIndex,\r\n          updateStepTabs: updateStepTabs,\r\n          direction: state.direction,\r\n          ...props,\r\n        });\r\n        if (child.props.validators) {\r\n          // eslint-disable-next-line prefer-destructuring\r\n          validators = child.props.validators;\r\n        }\r\n      }\r\n      if (child.type.displayName === \"ButtonsList\") {\r\n        buttonsListComponent = cloneElement(child, {\r\n          activeStepIndex: state.activeStepIndex,\r\n          totalSteps: state.totalSteps,\r\n          submitHandler,\r\n\r\n          onNextStep,\r\n          onPreviousStep,\r\n          validators,\r\n          ...props,\r\n        });\r\n      }\r\n    });\r\n    return { stepsComponent, buttonsListComponent };\r\n  };\r\n\r\n  const { stepsComponent, buttonsListComponent } = getInitialComponents();\r\n\r\n  return (\r\n    <div>\r\n      {/* <StepTabs tabs={state.stepTabs} activeStepIndex={state.activeStepIndex} /> */}\r\n      {stepsComponent}\r\n      {buttonsListComponent}\r\n    </div>\r\n  );\r\n};\r\n\r\nWizard.propTypes = {\r\n  className: PropTypes.string,\r\n  children: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.node), PropTypes.node]),\r\n};\r\n\r\nWizard.displayName = \"Wizard\";\r\n\r\nexport default Wizard;\r\n","import React, { Children, cloneElement, useEffect } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nconst Wrapper = styled.div`\r\n  position: relative;\r\n  height: 344px;\r\n`;\r\n\r\nconst StepsList = (props) => {\r\n  useEffect(() => {\r\n    const stepTabs = [];\r\n    Children.forEach(props.children, (child) => {\r\n      if (child.props.title) {\r\n        stepTabs.push({ title: child.props.title });\r\n      }\r\n    });\r\n    props.updateStepTabs(stepTabs); \r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const getStepChildren = () => {\r\n    const { activeStepIndex, children, direction, ...formik } = props;\r\n    const stepTabs = [];\r\n    const newChildren = Children.map(children, (child, index) => {\r\n      if (child.props.title) {\r\n        stepTabs.push({ title: child.props.title });\r\n      }\r\n      return cloneElement(child, {\r\n        isActive: index === activeStepIndex,\r\n        formik,\r\n        direction,\r\n      });\r\n    });\r\n    return newChildren;\r\n  };\r\n\r\n  return <Wrapper>{getStepChildren()}</Wrapper>;\r\n};\r\n\r\nStepsList.propTypes = {\r\n  activeStepIndex: PropTypes.number,\r\n  updateStepTabs: PropTypes.func,\r\n  children: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.node), PropTypes.node]),\r\n};\r\n\r\nStepsList.displayName = \"StepsList\";\r\n\r\nexport default StepsList;\r\n","import PropTypes from \"prop-types\";\r\nimport { useTransition, animated } from \"react-spring\";\r\nimport { Typography } from \"antd\";\r\n\r\nconst getX = (direction, actionPara) => 300 * direction * actionPara;\r\n\r\nconst Step = ({ isActive, component, direction, ...props }) => {\r\n  const y = direction === 0 ? 50 : -20;\r\n  const transition = useTransition(isActive, {\r\n    enter: { x: 0, y: 0, opacity: 1 },\r\n    from: { x: getX(direction, 1), y, opacity: 0 },\r\n    leave: { x: getX(direction, -1), y, opacity: 0 },\r\n  });\r\n\r\n  return transition((style, item) =>\r\n    item ? (\r\n      <animated.div style={{ position: \"absolute\", ...style }}>\r\n        <Typography.Title level={3}>{component?.title}</Typography.Title>\r\n        {component(props)}\r\n      </animated.div>\r\n    ) : (\r\n      <></>\r\n    )\r\n  );\r\n};\r\n\r\nStep.propTypes = {\r\n  isActive: PropTypes.bool,\r\n  component: PropTypes.func,\r\n  direction: PropTypes.number,\r\n};\r\n\r\nStep.displayName = \"Step\";\r\n\r\nexport default Step;\r\n","import React, { useState } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { Button, Tooltip } from \"antd\";\r\nimport colors from \"../../utils/colors\";\r\n\r\nconst WizardButton = ({ children, type, show, onClick, label, validator, ...props }) => {\r\n  const errorMsgs = (validator && validator.call(null)?.errorMsgs) || [];\r\n  const [tooltipVisible, setTooltipVisible] = useState(false);\r\n  const disabledNext = typeof validator === \"function\" && errorMsgs.length > 0;\r\n  return show ? (\r\n    children ? (\r\n      React.cloneElement(children, {\r\n        onClick: !validator || validator.call(null) ? onClick : null,\r\n        disabled: typeof validator === \"function\" && !validator.call(null),\r\n      })\r\n    ) : (\r\n      <Tooltip\r\n        title={errorMsgs && <span>{errorMsgs?.[0]}</span>}\r\n        color={colors.error}\r\n        visible={tooltipVisible}\r\n        onVisibleChange={(visible) => setTooltipVisible(visible && disabledNext)}\r\n      >\r\n        <Button\r\n          disabled={disabledNext}\r\n          type={type}\r\n          onClick={!validator || validator.call(null) ? onClick : null}\r\n          {...props}\r\n        >\r\n          {label || \"Next\"}\r\n        </Button>\r\n      </Tooltip>\r\n    )\r\n  ) : null;\r\n};\r\n\r\nWizardButton.defaultProps = {\r\n  type: \"button\",\r\n};\r\n\r\nWizardButton.propTypes = {\r\n  show: PropTypes.bool,\r\n  onClick: PropTypes.func,\r\n  label: PropTypes.oneOfType([PropTypes.string, PropTypes.element]),\r\n  validator: PropTypes.func,\r\n  children: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.node), PropTypes.node]),\r\n};\r\n\r\nWizardButton.displayName = \"WizardButton\";\r\n\r\nexport default WizardButton;\r\n","import React, { Children } from \"react\";\r\n\r\nimport { RocketOutlined } from \"@ant-design/icons\";\r\nimport styled from \"styled-components\";\r\nimport PropTypes from \"prop-types\";\r\nimport Button from \"./Button\";\r\n\r\nconst Wrapper = styled.div`\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  margin-top: 24px;\r\n`;\r\n\r\nconst ButtonsList = ({\r\n  activeStepIndex,\r\n  totalSteps,\r\n  onPreviousStep,\r\n  onNextStep,\r\n  onSubmit,\r\n  children,\r\n  validators,\r\n  ...formik\r\n}) => {\r\n  return (\r\n    <Wrapper>\r\n      {Children.map(children, (child) => {\r\n        const validator = validators[activeStepIndex];\r\n        if (child.type.displayName === \"PreviousButton\") {\r\n          return (\r\n            <Button\r\n              type=\"link\"\r\n              show={activeStepIndex > 0}\r\n              onClick={onPreviousStep}\r\n              label=\"上一步\"\r\n              {...child.props}\r\n            />\r\n          );\r\n        }\r\n        if (child.type.displayName === \"NextButton\") {\r\n          return (\r\n            <Button\r\n              type=\"primary\"\r\n              show={activeStepIndex < totalSteps}\r\n              onClick={onNextStep}\r\n              validator={validator}\r\n              label=\"下一步\"\r\n              {...child.props}\r\n            />\r\n          );\r\n        }\r\n        if (child.type.displayName === \"SubmitButton\") {\r\n          return (\r\n            <Button\r\n              show={activeStepIndex === totalSteps}\r\n              onClick={formik.submitHandler}\r\n              validator={validator}\r\n              type=\"primary\"\r\n              label={\r\n                <span>\r\n                  <RocketOutlined /> 送出\r\n                </span>\r\n              }\r\n              {...child.props}\r\n            />\r\n          );\r\n        }\r\n        return child;\r\n      })}\r\n    </Wrapper>\r\n  );\r\n};\r\n\r\nButtonsList.propTypes = {\r\n  activeStepIndex: PropTypes.number,\r\n  totalSteps: PropTypes.number,\r\n  onPreviousStep: PropTypes.func,\r\n  onNextStep: PropTypes.func,\r\n  onSubmit: PropTypes.func,\r\n  validators: PropTypes.array,\r\n  children: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.node), PropTypes.node]),\r\n};\r\n\r\nButtonsList.displayName = \"ButtonsList\";\r\n\r\nexport default ButtonsList;\r\n","const PreviousButton = () => null;\r\n\r\nPreviousButton.displayName = \"PreviousButton\";\r\n\r\nexport default PreviousButton;\r\n","const NextButton = () => null;\r\n\r\nNextButton.displayName = 'NextButton';\r\n\r\nexport default NextButton;","const SubmitButton = () => null;\r\n\r\nSubmitButton.displayName = \"SubmitButton\";\r\n\r\nexport default SubmitButton;\r\n","import { Formik } from \"formik\";\r\nimport Wizard from \"./Wizard\";\r\nimport StepsList from \"./StepsList\";\r\nimport Step from \"./Step\";\r\nimport ButtonsList from \"./ButtonsList\";\r\nimport PreviousButton from \"./PreviousButton\";\r\nimport NextButton from \"./NextButton\";\r\nimport SubmitButton from \"./SubmitButton\";\r\n\r\nfunction App({ components, initialValues, validationSchema, onSubmit, ...props }) {\r\n  return (\r\n    <Formik initialValues={initialValues}>\r\n      {(formik) => {\r\n        const getValidators = (validatorFuncs) =>\r\n          validatorFuncs.map((func) => () => func({ ...formik }));\r\n        return (\r\n          <Wizard onSubmit={onSubmit} initialValues={initialValues} {...formik} {...props}>\r\n            <StepsList\r\n              validators={getValidators(components.map(({ validate }) => validate || (() => true)))}\r\n            >\r\n              {components.map((c) => (\r\n                <Step key={c.title} component={c}></Step>\r\n              ))}\r\n            </StepsList>\r\n            <ButtonsList {...formik}>\r\n              <PreviousButton />\r\n              <NextButton />\r\n              <SubmitButton />\r\n            </ButtonsList>\r\n          </Wizard>\r\n        );\r\n      }}\r\n      {/* <DisplayFormikState {...props} /> */}\r\n    </Formik>\r\n  );\r\n}\r\n\r\n// const WithFormikApp = withFormik(App);\r\n\r\nexport default App;\r\n","import { Transfer } from \"antd\";\r\nimport { filterParticipants } from \"../../../utils/common\";\r\nimport { produce } from \"immer\";\r\n\r\nconst filterObject = (participants, filterKey) =>\r\n  filterParticipants(participants, { filter: { [filterKey]: true } }).map(([name]) => name);\r\n\r\nconst participantChangeHandler = (draft, options) => {\r\n  options.forEach(({ keys, action }) => {\r\n    const keySet = new Set(keys);\r\n    Object.entries(draft.participants).forEach(([name, obj]) => {\r\n      const included = keySet.has(name);\r\n      if (obj[action] !== included) {\r\n        draft.participants[name][action] = included;\r\n      }\r\n    });\r\n  });\r\n};\r\n\r\nconst SelectParticipants = ({ formik }) => {\r\n  const { participants } = formik.values;\r\n\r\n  const onChange = (nextTargetKeys) => {\r\n    formik.setValues(\r\n      produce(formik.values, (draft) => {\r\n        participantChangeHandler(draft, [\r\n          { keys: [], action: \"selected\" },\r\n          { keys: nextTargetKeys, action: \"targeted\" },\r\n        ]);\r\n      })\r\n    );\r\n  };\r\n\r\n  const onSelectChange = (sourceSelectedKeys, targetSelectedKeys) => {\r\n    const selectedKeys = [...sourceSelectedKeys, ...targetSelectedKeys];\r\n    formik.setValues(\r\n      produce(formik.values, (draft) => {\r\n        participantChangeHandler(draft, [{ keys: selectedKeys, action: \"selected\" }]);\r\n      })\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Transfer\r\n        dataSource={Object.values(participants)}\r\n        titles={[\"未訂餐\", \"有要訂餐\"]}\r\n        targetKeys={filterObject(participants, \"targeted\")}\r\n        selectedKeys={filterObject(participants, \"selected\")}\r\n        onChange={onChange}\r\n        onSelectChange={onSelectChange}\r\n        render={(item) => item.name}\r\n      ></Transfer>\r\n    </>\r\n  );\r\n};\r\n\r\nSelectParticipants.validate = (formik) => {\r\n  const errors = {};\r\n  const errorMsgs = [];\r\n  const { participants } = formik.values;\r\n  if (filterParticipants(participants).length < 2) {\r\n    errorMsgs.push(\"至少需選取2個訂餐人\");\r\n  }\r\n\r\n  if (errorMsgs.length > 0) {\r\n    errors.errorMsgs = errorMsgs;\r\n  }\r\n\r\n  return errors;\r\n};\r\n\r\nSelectParticipants.title = \"請選擇參與訂餐人\";\r\n\r\nexport default SelectParticipants;\r\n","import styled from \"styled-components\";\r\nimport { Typography } from \"antd\";\r\n\r\nconst { Text } = Typography;\r\n\r\nconst Wrapper = styled.div`\r\n  width: ${(props) => props.width}px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 8px;\r\n  & > * {\r\n    display: flex;\r\n  }\r\n`;\r\n\r\nconst FieldWrapper = ({ text = \"\", width = 275, children }) => (\r\n  <Wrapper width={width}>\r\n    {text === \"\" ? <></> : <Text>{text}</Text>}\r\n    {children}\r\n  </Wrapper>\r\n);\r\n\r\nexport default FieldWrapper;\r\n","import styled from \"styled-components\";\r\n\r\nimport { FastField } from \"formik\";\r\nimport colors from \"../../utils/colors\";\r\n\r\nconst StyledFastField = styled(FastField)`\r\n  outline: none;\r\n  cursor: pointer;\r\n  width: 155px;\r\n  height: 36px;\r\n  border-radius: 2px;\r\n  border: 1px\r\n    ${({ errors, touched }) => {\r\n      return errors && touched ? \"red\" : colors.getGray(0.2);\r\n    }}\r\n    solid;\r\n  padding-left: 4px;\r\n  font-size: ${(props) => props.fontSize}px;\r\n  transition: 0.2s ease-in-out;\r\n  &:hover {\r\n    border: 1px ${colors.getGray(0.25)} solid;\r\n    background-color: ${colors.getGray(0.15)};\r\n  }\r\n  /* &:focus {\r\n    background-color: ${colors.white};\r\n    border: 1px ${colors.primaryBackgroundLight} solid;\r\n  } */\r\n  ::-webkit-inner-spin-button {\r\n    -webkit-appearance: none;\r\n    margin: 0;\r\n  }\r\n  ::-webkit-outer-spin-button {\r\n    -webkit-appearance: none;\r\n    margin: 0;\r\n  }\r\n`;\r\n\r\nconst Field = ({ type = \"number\", ...props }) => (\r\n  <StyledFastField type={type} {...props}></StyledFastField>\r\n);\r\n\r\nexport default Field;\r\n","import { Typography } from \"antd\";\r\nimport styled from \"styled-components\";\r\n\r\nconst StyledText = styled(Typography.Text)`\r\n  font-size: ${(props) => props?.size}px;\r\n`;\r\n\r\nconst Text = ({ size = 16, children }) => {\r\n  return <StyledText size={size}>{children}</StyledText>;\r\n};\r\n\r\nexport default Text;\r\n","import FieldWrapper from \"../_wrapper/FieldWrapper\";\r\nimport Field from \"./Field\";\r\nimport Text from \"../../components/Text\";\r\n\r\nconst InputItem = ({ text, width, ...props }) => {\r\n  return (\r\n    <FieldWrapper text={text} width={width}>\r\n      <Field {...props}></Field>\r\n    </FieldWrapper>\r\n  );\r\n};\r\n\r\nexport default InputItem;\r\n","import Input from \"../../../components/Input\";\r\nimport { filterParticipants } from \"../../../utils/common\";\r\n\r\nconst RecordCost = ({ formik }) => {\r\n  const { participants } = formik.values;\r\n\r\n  return (\r\n    <>\r\n      {filterParticipants(participants).map(([name]) => {\r\n        return (\r\n          <Input\r\n            name={`participants[${name}].cost`}\r\n            key={name}\r\n            text={name}\r\n            value={formik?.values?.participants?.[name]?.cost}\r\n            onChange={formik.handleChange}\r\n            onBlur={formik.handleBlur}\r\n            touched={formik?.touched?.participants?.[name]}\r\n            errors={formik.errors[name]}\r\n            placeholder=\"enter somthing\"\r\n          ></Input>\r\n        );\r\n      })}\r\n    </>\r\n  );\r\n};\r\n\r\nRecordCost.validate = (formik) => {\r\n  const errors = {};\r\n  const errorMsgs = [];\r\n  const { participants } = formik.values;\r\n  const existUnfilled =\r\n    filterParticipants(participants, { filter: { targeted: true, cost: \"\" } }).length > 0;\r\n\r\n  if (existUnfilled) {\r\n    errorMsgs.push(\"需填寫所有訂餐人金額。若沒有訂餐請回上一步移除訂餐人。\");\r\n  }\r\n\r\n  if (errorMsgs.length > 0) {\r\n    errors.errorMsgs = errorMsgs;\r\n  }\r\n  return errors;\r\n};\r\n\r\nRecordCost.title = \"請輸入訂餐金額\";\r\n\r\nexport default RecordCost;\r\n","import { produce } from \"immer\";\r\nimport { Radio, Space } from \"antd\";\r\n\r\nimport { filterParticipants } from \"../../../utils/common\";\r\n\r\nconst SelectPayer = ({ formik }) => {\r\n  const { participants, payer } = formik.values;\r\n  return (\r\n    <>\r\n      <Radio.Group\r\n        buttonStyle=\"solid\"\r\n        value={payer}\r\n        onChange={(e) => {\r\n          formik.setValues(\r\n            produce(formik.values, (draft) => {\r\n              draft.payer = e.target.value;\r\n            })\r\n          );\r\n        }}\r\n      >\r\n        <Space direction=\"vertical\">\r\n          {filterParticipants(participants).map(([name]) => (\r\n            <Radio.Button key={name} value={name}>\r\n              {name}\r\n            </Radio.Button>\r\n          ))}\r\n        </Space>\r\n      </Radio.Group>\r\n    </>\r\n  );\r\n};\r\n\r\nSelectPayer.validate = (formik) => {\r\n  const errors = {};\r\n  const errorMsgs = [];\r\n  const { payer, participants } = formik.values;\r\n\r\n  if (!payer || !participants[payer].targeted) {\r\n    errorMsgs.push(\"請選擇付款人\");\r\n  }\r\n\r\n  if (errorMsgs.length > 0) {\r\n    errors.errorMsgs = errorMsgs;\r\n  }\r\n  return errors;\r\n};\r\n\r\nSelectPayer.title = \"請選擇付款人\";\r\n\r\nexport default SelectPayer;\r\n","import { produce } from \"immer\";\r\n\r\nimport Input from \"../../../components/Input\";\r\n\r\nconst SelectPayer = ({ formik }) => {\r\n  const { delivery, discount, note } = formik.values;\r\n  return (\r\n    <div>\r\n      <Input\r\n        text=\"運費\"\r\n        value={delivery?.fee || \"\"}\r\n        onChange={(e) => {\r\n          const { value } = e.target;\r\n          const fee = value === \"\" ? value : +value;\r\n          formik.setValues(\r\n            produce(formik.values, (draft) => {\r\n              draft.delivery.fee = fee;\r\n            })\r\n          );\r\n        }}\r\n        placeholder=\"請輸入運費\"\r\n      ></Input>\r\n      <Input\r\n        text=\"優惠\"\r\n        value={discount?.amount || \"\"}\r\n        onChange={(e) => {\r\n          const { value } = e.target;\r\n          const amount = value === \"\" ? value : +value;\r\n          formik.setValues(\r\n            produce(formik.values, (draft) => {\r\n              draft.discount.amount = amount;\r\n            })\r\n          );\r\n        }}\r\n        placeholder=\"請輸入優惠\"\r\n      ></Input>\r\n      <Input\r\n        type=\"text\"\r\n        text=\"備註\"\r\n        value={note || \"\"}\r\n        onChange={(e) => {\r\n          const { value } = e.target;\r\n          formik.setValues(\r\n            produce(formik.values, (draft) => {\r\n              draft.note = value;\r\n            })\r\n          );\r\n        }}\r\n      ></Input>\r\n    </div>\r\n  );\r\n};\r\n\r\nSelectPayer.title = \"其他選項\";\r\n\r\nexport default SelectPayer;\r\n","import { Table, Typography, Tooltip } from \"antd\";\r\nimport { CrownTwoTone } from \"@ant-design/icons\";\r\n\r\nimport { filterParticipants, fixNumber } from \"../../../utils/common\";\r\nimport colors from \"../../../utils/colors\";\r\n\r\nconst arrangeValues = (values) => {\r\n  const {\r\n    delivery: { fee: deliveryFee = 0 },\r\n    discount: { amount: discountAmount = 0 },\r\n    participants = {},\r\n    payer = \"\",\r\n  } = values;\r\n  const filteredParticipants = filterParticipants(participants);\r\n  const totalAmount = filteredParticipants.reduce((acc, [_, { cost }]) => acc + cost, 0);\r\n  const participantCount = filteredParticipants.length;\r\n  const totalSharedFee = deliveryFee - discountAmount;\r\n  const sharedFee = fixNumber(totalSharedFee / participantCount);\r\n  const columns = [\r\n    {\r\n      title: \"訂餐人\",\r\n      dataIndex: \"name\",\r\n      key: \"name\",\r\n      render: (text) => (\r\n        <Tooltip title={payer === text ? \"付款人\" : null}>\r\n          <Typography.Text strong>\r\n            {payer === text && <CrownTwoTone twoToneColor={colors.mark} />}\r\n            {text}\r\n          </Typography.Text>\r\n        </Tooltip>\r\n      ),\r\n    },\r\n\r\n    {\r\n      title: \"金額\",\r\n      dataIndex: \"cost\",\r\n      key: \"cost\",\r\n      render: (cost) => (\r\n        <Tooltip title={`${cost} ${sharedFee >= 0 ? \"+\" : \"-\"} ${Math.abs(sharedFee)}`}>\r\n          <Typography.Link target=\"_blank\">{fixNumber(cost + sharedFee)}</Typography.Link>\r\n        </Tooltip>\r\n      ),\r\n    },\r\n  ];\r\n  const dataSource = filteredParticipants.map(([name, { cost }]) => ({\r\n    key: name,\r\n    name,\r\n    cost,\r\n  }));\r\n  return {\r\n    discountAmount,\r\n    totalAmount,\r\n    deliveryFee,\r\n    totalSharedFee,\r\n    participantCount,\r\n    sharedFee,\r\n    dataSource,\r\n    columns,\r\n  };\r\n};\r\n\r\nconst ResultsPreview = ({ formik }) => {\r\n  const { values } = formik;\r\n  const {\r\n    discountAmount,\r\n    deliveryFee,\r\n    totalAmount,\r\n    totalSharedFee,\r\n    participantCount,\r\n    sharedFee,\r\n    dataSource,\r\n    columns,\r\n  } = arrangeValues(values);\r\n  const { note } = values;\r\n  return (\r\n    <>\r\n      <Typography.Text strong>{sharedFee < 0 ? \"共享優惠\" : \"共同分擔\"}：</Typography.Text>\r\n      <Tooltip title={`運費：${deliveryFee}，優惠：${discountAmount}`}>\r\n        <Typography.Link target=\"_blank\">{Math.abs(totalSharedFee)}</Typography.Link>\r\n      </Tooltip>{\" \"}\r\n      ÷ {participantCount} = {Math.abs(sharedFee)}\r\n      <br></br>\r\n      <Typography.Text strong>備註：</Typography.Text>\r\n      {note ? note : <Typography.Text type=\"secondary\">無備註</Typography.Text>}\r\n      <Table\r\n        scroll={{ y: 300 }}\r\n        size=\"small\"\r\n        pagination={false}\r\n        columns={columns}\r\n        dataSource={dataSource}\r\n        summary={() => (\r\n          <Table.Summary fixed>\r\n            <Table.Summary.Row>\r\n              <Table.Summary.Cell index={0}>總額</Table.Summary.Cell>\r\n              <Table.Summary.Cell index={1}>{totalAmount + totalSharedFee}</Table.Summary.Cell>\r\n            </Table.Summary.Row>\r\n          </Table.Summary>\r\n        )}\r\n      ></Table>\r\n    </>\r\n  );\r\n};\r\n\r\nResultsPreview.title = \"結果預覽\";\r\n\r\nexport default ResultsPreview;\r\n","import Modal from \"../../../components/Modal\";\r\n\r\nimport FormikWizard from \"../../../components/FormikWizard\";\r\n\r\nimport SelectParticipants from \"./SelectParticipants\";\r\nimport RecordCost from \"./RecordCost\";\r\nimport SelectPayer from \"./SelectPayer\";\r\nimport RecordOtherStuff from \"./RecordOtherStuff\";\r\nimport ResultsPreview from \"./ResultsPreview\";\r\n\r\nconst components = [SelectParticipants, RecordCost, SelectPayer, RecordOtherStuff, ResultsPreview];\r\n\r\nconst CURDRecordModal = ({ initialValues, button, buttonTitle = \"新增一筆記錄\", onSubmit }) => {\r\n  return (\r\n    <Modal button={button} buttonTitle={buttonTitle}>\r\n      <FormikWizard\r\n        initialValues={initialValues}\r\n        components={components}\r\n        onSubmit={onSubmit}\r\n      ></FormikWizard>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default CURDRecordModal;\r\n","import React, { useState, Children, cloneElement, useEffect } from \"react\";\r\nimport { Popconfirm } from \"antd\";\r\n\r\nconst _Popconfirm = ({ children, popconfirmTitle = \"title\", onConfirm, ...props }) => {\r\n  const [visible, setVisible] = useState(false);\r\n  const [confirmLoading, setConfirmLoading] = useState(false);\r\n\r\n  useEffect(\r\n    () => () => {\r\n      setVisible(null);\r\n      setConfirmLoading(null);\r\n    },\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    []\r\n  );\r\n\r\n  const showPopconfirm = () => {\r\n    setVisible(true);\r\n  };\r\n\r\n  const handleOk = async () => {\r\n    setConfirmLoading(true);\r\n    await onConfirm();\r\n    setVisible(false);\r\n    setConfirmLoading(false);\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setVisible(false);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Popconfirm\r\n        title={popconfirmTitle}\r\n        visible={visible}\r\n        onConfirm={handleOk}\r\n        okButtonProps={{ loading: confirmLoading }}\r\n        onCancel={handleCancel}\r\n        onVisibleChange={(visible) => {\r\n          if (!visible) {\r\n            setVisible(false);\r\n          }\r\n        }}\r\n      >\r\n        {Children.map(children, (child) =>\r\n          cloneElement(child, {\r\n            onClick: showPopconfirm,\r\n            ...props,\r\n          })\r\n        )}\r\n      </Popconfirm>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default _Popconfirm;\r\n","import styled from \"styled-components\";\r\n\r\nconst StyledButton = styled.button`\r\n  outline: none;\r\n  border: none;\r\n  background-color: transparent;\r\n  box-shadow: rgba(99, 99, 99, 0.2) 0px 0px 8px 0px;\r\n  cursor: pointer;\r\n  margin: 20px;\r\n  border-radius: 4px;\r\n  transition: 1.9s cubic-bezier(0.075, 0.82, 0.165, 1);\r\n  margin: 4px;\r\n  &:hover {\r\n    box-shadow: rgba(20, 20, 20, 0.4) 0px 0px 13px 2px;\r\n  }\r\n  &:active {\r\n    box-shadow: rgba(99, 99, 99, 0.2) 0px 0px 4px 0px;\r\n    background-color: rgba(99, 99, 99, 0.2);\r\n  }\r\n`;\r\n\r\nconst IconButton = ({ children, ...props }) => {\r\n  return <StyledButton {...props}>{children}</StyledButton>;\r\n};\r\n\r\nexport default IconButton;\r\n","import moment from \"moment\";\r\nimport { Tooltip, Typography } from \"antd\";\r\nimport { DeleteTwoTone, EditTwoTone } from \"@ant-design/icons\";\r\n\r\nimport { removeRecord, updateRecord } from \"../../../redux/record/action\";\r\nimport { filterParticipants } from \"../../../utils/common\";\r\n\r\nimport AddNewRecordModal from \"../../_common/CURDRecordModal\";\r\n\r\nimport Popconfirm from \"../../../components/Popconfirm\";\r\nimport IconButton from \"../../../components/IconButton\";\r\nimport { volcano, green } from \"@ant-design/colors\";\r\n\r\nconst { Text, Link } = Typography;\r\n\r\nconst genDefaultRecord = (record, index, dispatch) => {\r\n  const { participants, payer, delivery, discount, note, id } = record;\r\n  const deliveryFee = delivery?.fee || 0;\r\n  const discountAmount = discount?.amount || 0;\r\n  const sharingFee = discountAmount - deliveryFee;\r\n  const arrangedParticipants = Object.entries(participants)\r\n    .map(([name, { cost, targeted }]) => ({\r\n      name,\r\n      cost: targeted ? cost : <Text type=\"secondary\">無參加</Text>,\r\n    }))\r\n    .reduce(\r\n      (acc, { name, cost }) => ({\r\n        ...acc,\r\n        ...{ [name]: cost },\r\n      }),\r\n      {}\r\n    );\r\n  return {\r\n    key: `${index + 1}`,\r\n    date: record,\r\n    sharingFee: (\r\n      <Tooltip\r\n        title={\r\n          <div>\r\n            <p style={{ color: volcano[1], margin: 0 }}>運費：{deliveryFee}</p>\r\n            <p style={{ color: green[1], margin: 0 }}>優惠：{discountAmount}</p>\r\n          </div>\r\n        }\r\n      >\r\n        <Link>{sharingFee}</Link>\r\n      </Tooltip>\r\n    ),\r\n    payer: record,\r\n    discountAmount,\r\n    ...arrangedParticipants,\r\n    deliveryFee,\r\n    totalAmount: filterParticipants(participants).reduce(\r\n      (acc, [_, { cost = 0 }]) => acc + cost,\r\n      deliveryFee - discountAmount\r\n    ),\r\n    note,\r\n    action: (\r\n      <div>\r\n        <AddNewRecordModal\r\n          initialValues={record}\r\n          button={\r\n            <Tooltip title=\"編輯此筆記錄\" placement=\"bottomLeft\">\r\n              <IconButton>\r\n                <EditTwoTone twoToneColor={green[5]} />\r\n              </IconButton>\r\n            </Tooltip>\r\n          }\r\n          onSubmit={(record) => {\r\n            dispatch(updateRecord({ recordId: record.id, updatedRecord: record }));\r\n          }}\r\n        >\r\n          Update\r\n        </AddNewRecordModal>\r\n        <Popconfirm\r\n          popconfirmTitle=\"即將刪除此筆記錄\"\r\n          onConfirm={() => dispatch(removeRecord({ removingId: id }))}\r\n        >\r\n          <Tooltip title=\"刪除此筆記錄\" placement=\"bottomLeft\">\r\n            <IconButton>\r\n              <DeleteTwoTone twoToneColor={volcano[5]} />\r\n            </IconButton>\r\n          </Tooltip>\r\n        </Popconfirm>\r\n      </div>\r\n    ),\r\n  };\r\n};\r\n\r\nexport default genDefaultRecord;\r\n","import { useSelector, useDispatch } from \"react-redux\";\r\nimport { Table, Spin } from \"antd\";\r\n\r\nimport generateColumns from \"./functions/generateColumns\";\r\nimport genDefaultRecord from \"./functions/genDefaultRecord\";\r\nimport genTranferMoneyRecord from \"./functions/genTranferMoneyRecord\";\r\n\r\nconst generateDataSource = (records, dispatch) => {\r\n  return records.map((record, i) => {\r\n    const { type } = record;\r\n    switch (type) {\r\n      // case \"TRANSFER_MONEY\":\r\n      //   return genTranferMoneyRecord(record, i, dispatch);\r\n      default:\r\n        return genDefaultRecord(record, i, dispatch);\r\n    }\r\n  });\r\n};\r\n\r\nconst DataTable = () => {\r\n  const dispatch = useDispatch();\r\n  const { data: records, loading } = useSelector((state) => state.records);\r\n  const columns = generateColumns(records);\r\n  const dataSource = generateDataSource(records, dispatch);\r\n  return (\r\n    <Spin spinning={loading}>\r\n      <Table\r\n        dataSource={dataSource}\r\n        columns={columns}\r\n        scroll={{ x: 1000 }}\r\n        pagination={{ pageSize: 4 }}\r\n      ></Table>\r\n    </Spin>\r\n  );\r\n};\r\nexport default DataTable;\r\n","import moment from \"moment\";\r\nimport { Tooltip, Typography } from \"antd\";\r\nimport { DeleteTwoTone, EditTwoTone } from \"@ant-design/icons\";\r\n\r\nimport { removeRecord, updateRecord } from \"../../../redux/record/action\";\r\nimport { filterParticipants } from \"../../../utils/common\";\r\n\r\nimport AddNewRecordModal from \"../../_common/CURDRecordModal\";\r\n\r\nimport Popconfirm from \"../../../components/Popconfirm\";\r\nimport IconButton from \"../../../components/IconButton\";\r\nimport { volcano, green } from \"@ant-design/colors\";\r\n\r\nconst { Text, Link } = Typography;\r\n\r\nconst genTranferMoneyRecord = (record, index, dispatch) => {\r\n  const { participants, payer, delivery, discount, note, id } = record;\r\n  const deliveryFee = delivery?.fee || 0;\r\n  const discountAmount = discount?.amount || 0;\r\n  const sharingFee = discountAmount - deliveryFee;\r\n  const arrangedParticipants = Object.entries(participants)\r\n    .map(([name, { cost, targeted }]) => ({\r\n      name,\r\n      cost: targeted ? cost : <Text type=\"secondary\">無參加</Text>,\r\n    }))\r\n    .reduce(\r\n      (acc, { name, cost }) => ({\r\n        ...acc,\r\n        ...{ [name]: cost },\r\n      }),\r\n      {}\r\n    );\r\n  return {\r\n    key: `${index + 1}`,\r\n    date: record,\r\n\r\n    payer: {\r\n      children: <span style={{ whiteSpace: \"nowrap\" }}>33231123112312131232315443543</span>,\r\n    },\r\n\r\n    action: (\r\n      <div>\r\n        <AddNewRecordModal\r\n          initialValues={record}\r\n          button={\r\n            <Tooltip title=\"編輯此筆記錄\" placement=\"bottomLeft\">\r\n              <IconButton>\r\n                <EditTwoTone twoToneColor={green[5]} />\r\n              </IconButton>\r\n            </Tooltip>\r\n          }\r\n          onSubmit={(record) => {\r\n            dispatch(updateRecord({ recordId: record.id, updatedRecord: record }));\r\n          }}\r\n        >\r\n          Update\r\n        </AddNewRecordModal>\r\n        <Popconfirm\r\n          popconfirmTitle=\"即將刪除此筆記錄\"\r\n          onConfirm={() => dispatch(removeRecord({ removingId: id }))}\r\n        >\r\n          <Tooltip title=\"刪除此筆記錄\" placement=\"bottomLeft\">\r\n            <IconButton>\r\n              <DeleteTwoTone twoToneColor={volcano[5]} />\r\n            </IconButton>\r\n          </Tooltip>\r\n        </Popconfirm>\r\n      </div>\r\n    ),\r\n  };\r\n};\r\n\r\nexport default genTranferMoneyRecord;\r\n","import styled from \"styled-components\";\r\nimport { Button as _Button } from \"antd\";\r\n\r\nconst StyledButton = styled(_Button)`\r\n`;\r\n\r\nconst Button = (props) => {\r\n  return <StyledButton {...props}>{props.children}</StyledButton>;\r\n};\r\n\r\nexport default Button;\r\n","import * as yup from \"yup\";\r\nimport styled from \"styled-components\";\r\nimport { Select } from \"antd\";\r\nimport { Formik, Form, ErrorMessage } from \"formik\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { addUser } from \"../../redux/user/action\";\r\nimport Modal from \"../../components/Modal\";\r\nimport Input from \"../../components/Input\";\r\nimport Button from \"../../components/Button\";\r\n\r\nconst { Option } = Select;\r\n\r\nconst Wrapper = styled.div`\r\n  margin-top: 24px;\r\n`;\r\n\r\nconst AddUserModal = () => {\r\n  const userData = useSelector((state) => state?.users || {});\r\n  const { data: users } = userData;\r\n  const dispatch = useDispatch();\r\n  return (\r\n    <Modal buttonTitle=\"新增使用者\" title=\"新增使用者\">\r\n      <Formik\r\n        initialValues={{ userName: \"\" }}\r\n        validationSchema={() =>\r\n          yup.object().shape({\r\n            userName: yup.string().required(\"必須填寫使用者名稱\"),\r\n          })\r\n        }\r\n      >\r\n        {(formik) => {\r\n          const {\r\n            values: { userName },\r\n          } = formik;\r\n          return (\r\n            <Form>\r\n              <Wrapper>\r\n                <Input\r\n                  type=\"text\"\r\n                  text=\"使用者名稱\"\r\n                  name=\"userName\"\r\n                  onChange={formik.handleChange}\r\n                  onBlur={formik.handleBlur}\r\n                ></Input>\r\n                <ErrorMessage name=\"userName\"></ErrorMessage>\r\n              </Wrapper>\r\n              <Wrapper>\r\n                <Select style={{ width: 150 }}>\r\n                  {Object.entries(users).map(([name]) => (\r\n                    <Option key={name}>{name}</Option>\r\n                  ))}\r\n                </Select>\r\n              </Wrapper>\r\n              <Wrapper>\r\n                <Button\r\n                  type=\"primary\"\r\n                  onClick={() => {\r\n                    dispatch(addUser({ userName }));\r\n                  }}\r\n                >\r\n                  新增使用者\r\n                </Button>\r\n              </Wrapper>\r\n            </Form>\r\n          );\r\n        }}\r\n      </Formik>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default AddUserModal;\r\n","import CURDRecordModal from \"../_common/CURDRecordModal\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { addNewRecord } from \"../../redux/record/action\";\r\nimport { genNewRecordObject } from \"../../utils/common\";\r\n\r\nconst AddNewRecordModal = () => {\r\n  const users = useSelector((state) => state?.users?.data || {});\r\n  \r\n  const initNewRecord = genNewRecordObject(users);\r\n  const dispatch = useDispatch();\r\n\r\n  return (\r\n    <CURDRecordModal\r\n      initialValues={initNewRecord}\r\n      buttonTitle=\"新增一筆資料\"\r\n      onSubmit={(record) => {\r\n        dispatch(addNewRecord(record));\r\n      }}\r\n    ></CURDRecordModal>\r\n  );\r\n};\r\n\r\nexport default AddNewRecordModal;\r\n","import { Field, FastField } from \"formik\";\r\nimport FieldWrapper from \"../_wrapper/FieldWrapper\";\r\n\r\nexport const FormikField = ({ text, fast, children, ...restProps }) => (\r\n  <FieldWrapper text={text}>\r\n    {fast ? (\r\n      <FastField {...restProps}>{children}</FastField>\r\n    ) : (\r\n      <Field {...restProps}>{children}</Field>\r\n    )}\r\n  </FieldWrapper>\r\n);\r\nexport default FormikField;\r\n","import { Select } from \"antd\";\r\nimport Field from \"../FormikField\";\r\n\r\nexport const FormikSelect = ({\r\n  text,\r\n  name,\r\n  validate,\r\n  fast,\r\n  children,\r\n  onChange,\r\n  onBlur,\r\n  ...restProps\r\n}) => {\r\n  return (\r\n    <Field text={text} name={name} validate={validate} fast={fast}>\r\n      {({ field: { value }, form: { setFieldValue, setFieldTouched } }) => (\r\n        <Select\r\n          onChange={(value, option) => {\r\n            setFieldValue(name, value);\r\n            onChange && onChange(value, option);\r\n          }}\r\n          onBlur={(value) => {\r\n            setFieldTouched(name);\r\n            onBlur && onBlur(value);\r\n          }}\r\n          value={value === \"\" || value === null ? undefined : value}\r\n          {...restProps}\r\n        >\r\n          {children}\r\n        </Select>\r\n      )}\r\n    </Field>\r\n  );\r\n};\r\n\r\nFormikSelect.Option = Select.Option;\r\n\r\nexport default FormikSelect;\r\n","// import { produce } from \"immer\";\r\n// import { Radio, Space, Steps } from \"antd\";\r\nimport FormikSelect from \"../../../components/FormikSelect\";\r\nimport Input from \"../../../components/Input\";\r\n\r\nimport React from \"react\";\r\n\r\nconst { Option } = FormikSelect;\r\nconst SelectPayer = ({ formik }) => {\r\n  const { participants, payer, payee, transferAmount } = formik.values;\r\n  // const  onChange= (value)=> {\r\n  //   console.log(`selected ${value}`);\r\n  // }\r\n\r\n  // function onBlur() {\r\n  //   console.log(\"blur\");\r\n  // }\r\n\r\n  // function onFocus() {\r\n  //   console.log(\"focus\");\r\n  // }\r\n\r\n  // function onSearch(val) {\r\n  //   console.log(\"search:\", val);\r\n  // }\r\n  return (\r\n    <>\r\n      <FormikSelect\r\n        name=\"payer\"\r\n        text=\"付款人\" \r\n        showSearch\r\n        style={{ width: 155 }}\r\n        placeholder=\"Select a person\"\r\n        optionFilterProp=\"children\"\r\n        filterOption={(input, option) =>\r\n          option.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\r\n        }\r\n      >\r\n        {Object.keys(participants).map((participant) => (\r\n          <Option key={participant} value={participant} disabled={payee === participant}>\r\n            {participant}\r\n          </Option>\r\n        ))}\r\n      </FormikSelect>\r\n      <FormikSelect\r\n        name=\"payee\"\r\n        text=\"收款人\"\r\n        showSearch\r\n        style={{ width: 155 }}\r\n        placeholder=\"Select a person\"\r\n        optionFilterProp=\"children\"\r\n        filterOption={(input, option) =>\r\n          option.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\r\n        }\r\n      >\r\n        {Object.keys(participants).map((participant) => (\r\n          <Option key={participant} value={participant} disabled={payer === participant}>\r\n            {participant}\r\n          </Option>\r\n        ))}\r\n      </FormikSelect>\r\n      <Input\r\n        text=\"金額\"\r\n        value={transferAmount}\r\n        name=\"transferAmount\"\r\n        placeholder=\"請輸入金額\"\r\n      ></Input>\r\n      {/* <Radio.Group\r\n        buttonStyle=\"solid\"\r\n        value={payer}\r\n        onChange={(e) => {\r\n          formik.setValues(\r\n            produce(formik.values, (draft) => {\r\n              draft.payer = e.target.value;\r\n            })\r\n          );\r\n        }}\r\n      >\r\n        <Space direction=\"vertical\">\r\n          {Object.entries(participants).map(([name]) => (\r\n            <Radio.Button key={name} value={name}>\r\n              {name}\r\n            </Radio.Button>\r\n          ))}\r\n        </Space>\r\n      </Radio.Group> */}\r\n    </>\r\n  );\r\n};\r\n\r\nSelectPayer.validate = (formik) => {\r\n  const errors = {};\r\n  const errorMsgs = [];\r\n  const { transferAmount, payer, payee } = formik.values;\r\n  if (!transferAmount) {\r\n    errorMsgs.push(\"請輸入金額\");\r\n  }\r\n  if (!payer) {\r\n    errorMsgs.push(\"請選擇付款人\");\r\n  }\r\n  if (!payee) {\r\n    errorMsgs.push(\"請選擇收款人\");\r\n  }\r\n  if (errorMsgs.length > 0) {\r\n    errors.errorMsgs = errorMsgs;\r\n  }\r\n\r\n  return errors;\r\n};\r\n\r\nSelectPayer.title = \"請填寫轉錢資訊\";\r\n\r\nexport default SelectPayer;\r\n","import Modal from \"../../../components/Modal\";\r\n\r\nimport FormikWizard from \"../../../components/FormikWizard\";\r\n\r\nimport RecordInfo from \"./RecordInfo\";\r\n\r\nconst components = [RecordInfo];\r\n\r\nconst addNecessaryAttributions = (initialValues) => ({\r\n  participants: initialValues.participants,\r\n  payer: \"\",\r\n  payee: \"\",\r\n  transferAmount: \"\",\r\n});\r\n\r\nconst TransferMoneyModal = ({ loading, initialValues, button, buttonTitle = \"轉錢\", onSubmit }) => {\r\n  const values = addNecessaryAttributions(initialValues);\r\n  \r\n  return (\r\n    <Modal loading={loading} button={button} buttonTitle={buttonTitle}>\r\n      <FormikWizard\r\n        initialValues={values}\r\n        components={components}\r\n        onSubmit={onSubmit}\r\n      ></FormikWizard>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default TransferMoneyModal;\r\n","import { produce } from \"immer\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport TransferMoneyModal from \"../_common/TransferMoneyModal\";\r\nimport { addNewRecord } from \"../../redux/record/action\";\r\nimport { genNewRecordObject } from \"../../utils/common\";\r\n\r\nconst TransferMoney = () => {\r\n  const userObject = useSelector((state) => state?.users || {});\r\n\r\n  const { data: users = {}, loading } = userObject;\r\n  const initNewTransferRecord = { ...genNewRecordObject(users), type: \"TRANSFER_MONEY\" };\r\n  const dispatch = useDispatch();\r\n\r\n  return (\r\n    <TransferMoneyModal\r\n      initialValues={initNewTransferRecord}\r\n      buttonTitle=\"轉錢\"\r\n      loading={loading}\r\n      onSubmit={(record) => {\r\n        const { payer, payee, transferAmount } = record;\r\n        const resultRecord = produce(initNewTransferRecord, (draft) => {\r\n          Object.entries(draft.participants).forEach(([name, obj]) => {\r\n            if (name !== payee && name !== payer) {\r\n              obj.targeted = false;\r\n            }\r\n          });\r\n          draft.participants[payee].cost = transferAmount;\r\n          draft.participants[payer].cost = 0;\r\n          draft.payer = payer;\r\n          draft.note = `${payer}轉給${payee} ${transferAmount}元`;\r\n        });\r\n        console.log(resultRecord);\r\n        dispatch(addNewRecord(resultRecord));\r\n      }}\r\n    ></TransferMoneyModal>\r\n  );\r\n};\r\n\r\nexport default TransferMoney;\r\n","import AddUserModal from \"./AddUserModal\";\r\nimport AddNewRecordModal from \"./AddNewRecordModal\";\r\nimport TransferMoney from './TransferMoney'\r\n\r\nconst Panel = () => {\r\n  return (\r\n    <div\r\n      style={{\r\n        display: \"flex\",\r\n        height: \"100%\",\r\n        alignItems: \"center\",\r\n        justifyContent: \"flex-end\",\r\n      }}\r\n    >\r\n      <TransferMoney></TransferMoney>\r\n      <AddUserModal></AddUserModal>\r\n      <AddNewRecordModal></AddNewRecordModal>\r\n    </div>\r\n  );\r\n};\r\nexport default Panel;\r\n","import { Affix, Layout } from \"antd\";\r\nimport GitHubButton from \"react-github-btn\";\r\nimport { useEffect } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { loadAllRecords } from \"./redux/record/action\";\r\nimport { loadAllUsers } from \"./redux/user/action\";\r\nimport DataTable from \"./containers/DataTable\";\r\nimport Panel from \"./containers/Panel\";\r\n\r\nimport { usingLocalDB } from \"./firebase/init\";\r\n\r\nconst { Header, Content, Footer, Sider } = Layout;\r\nconst App = () => {\r\n    const dispatch = useDispatch();\r\n    useEffect(() => {\r\n        dispatch(loadAllRecords());\r\n        dispatch(loadAllUsers());\r\n    }, [dispatch]);\r\n\r\n    return (\r\n        <>\r\n            <Layout className=\"site-layout\">\r\n                <Header className=\"site-layout-background\" style={{ padding: 0 }}>\r\n                    <Panel></Panel>\r\n                </Header>\r\n                <Layout>\r\n                    {/* <Sider>32</Sider> */}\r\n                    <Content style={{ margin: 16, borderRadius: 4 }}>\r\n                        <DataTable></DataTable>\r\n                    </Content>\r\n                </Layout>\r\n                <Footer style={{ textAlign: \"center\" }}>\r\n                    <Affix offsetBottom={10}>\r\n                        <div>\r\n                            {usingLocalDB ? (\r\n                                <p>\r\n                                    您現在使用的是離線版本的Let's go dutch! ，如果想使用雲端版本的Let's go\r\n                                    dutch! ，可以參考\r\n                                    <a href=\"https://github.com/RuChuanLin/letsgodutch#installation\">\r\n                                        這篇教學\r\n                                    </a>\r\n                                    。\r\n                                </p>\r\n                            ) : null}\r\n\r\n                            <p>\r\n                                如果您喜歡這個專案，請鼓勵作者一個Github星星~\r\n                                <GitHubButton\r\n                                    href=\"https://github.com/RuChuanLin/letsgodutch\"\r\n                                    data-size=\"large\"\r\n                                    aria-label=\"Star RuChuanLin/letsgodutch on GitHub\"\r\n                                >\r\n                                    Star\r\n                                </GitHubButton>\r\n                            </p>\r\n                        </div>\r\n                    </Affix>\r\n                </Footer>\r\n            </Layout>\r\n        </>\r\n    );\r\n};\r\nexport default App;\r\n","const reducerHandler = (state, action, data) => {\r\n  switch (action.httpState) {\r\n    case \"REQUEST\":\r\n      return {\r\n        ...state,\r\n        loading: true,\r\n      };\r\n    case \"SUCCESS\":\r\n      return {\r\n        ...state,\r\n        data: data ? data : action.data,\r\n        loading: false,\r\n        error: null,\r\n      };\r\n    case \"FAILURE\":\r\n      return {\r\n        ...state,\r\n        loading: false,\r\n        error: data ? data : action.data,\r\n        data: null,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default reducerHandler;\r\n","import reducerHandler from \"../utils/reducerHandler\";\r\n\r\nimport {\r\n  loadAllRecordsActions,\r\n  addNewRecordActions,\r\n  updateRecordActions,\r\n  removeRecordActions,\r\n} from \"./action\";\r\nconst initialState = { data: [] };\r\n\r\nconst reducer = (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case loadAllRecordsActions.REQUEST:\r\n    case loadAllRecordsActions.SUCCESS:\r\n    case loadAllRecordsActions.FAILURE:\r\n    case addNewRecordActions.REQUEST:\r\n    case addNewRecordActions.SUCCESS:\r\n    case addNewRecordActions.FAILURE:\r\n    case updateRecordActions.REQUEST:\r\n    case updateRecordActions.SUCCESS:\r\n    case updateRecordActions.FAILURE:\r\n    case removeRecordActions.REQUEST:\r\n    case removeRecordActions.SUCCESS:\r\n    case removeRecordActions.FAILURE:\r\n      return reducerHandler(state, action);\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default reducer;\r\n","\r\n\r\nimport { loadAllUsersActions, addUserActions } from \"./action\";\r\nimport reducerHandler from \"../utils/reducerHandler\";\r\n\r\nconst initialState = {};\r\n\r\nconst reducer = (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case loadAllUsersActions.REQUEST:\r\n    case loadAllUsersActions.SUCCESS:\r\n    case loadAllUsersActions.FAILURE:\r\n    case addUserActions.REQUEST:\r\n    case addUserActions.SUCCESS:\r\n    case addUserActions.FAILURE:\r\n      return reducerHandler(state, action);\r\n\r\n    // return reducerHandler(\r\n    //   state,\r\n    //   action,\r\n    //   produce(state.data, (draft) => {\r\n    //     draft[action.data.name] = action.data;\r\n    //   }),\r\n    //   action\r\n    // );\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default reducer;\r\n","export const snapshots2Docs = (snapshots) => (snapshots?.docs ? snapshots.docs : snapshots);\r\nexport const snapshot2Data = (snapshot) => {\r\n  if (snapshot?.data && typeof snapshot.data === \"function\") {\r\n    return snapshot.data();\r\n  }\r\n  return snapshot;\r\n};\r\n\r\nexport const getIdFromAddedObject = (addedObject) => {\r\n  if (typeof addedObject === \"string\") {\r\n    return addedObject;\r\n  }\r\n  return addedObject?.data?.key;\r\n};\r\n","import moment from \"moment\";\r\nimport { produce } from \"immer\";\r\nimport { nanoid } from \"nanoid\";\r\nimport { all, takeLatest, put, select } from \"redux-saga/effects\";\r\nimport { snapshots2Docs, snapshot2Data } from \"../../utils/dbApiUnification\";\r\nimport { getUserDB } from \"../../firebase\";\r\nimport { loadAllUsersActions, addUserActions } from \"./action\";\r\n\r\nfunction* loadAllUsers() {\r\n  try {\r\n    const snapshots = yield getUserDB().get();\r\n    const docs = snapshots2Docs(snapshots);\r\n    const userObject = docs\r\n      .map(snapshot2Data)\r\n      .reduce((acc, cur) => ({ ...acc, [cur.name]: {} }), {});\r\n    yield put(loadAllUsersActions.success(userObject));\r\n  } catch (err) {\r\n    yield put(loadAllUsersActions.failure(err));\r\n  }\r\n}\r\n\r\nfunction* addUser({ data }) {\r\n  const { userName } = data;\r\n  if (userName) {\r\n    const users = yield select((state) => state?.users?.data);\r\n    try {\r\n      const id = nanoid();\r\n      const userObject = {\r\n        name: userName,\r\n        date: new moment().valueOf(),\r\n        id,\r\n      };\r\n      yield getUserDB().doc(id).set(userObject);\r\n      yield put(\r\n        addUserActions.success(\r\n          produce(users, (draft) => {\r\n            draft[userName] = userObject;\r\n          })\r\n        )\r\n      );\r\n    } catch (err) {\r\n      yield put(addUserActions.failure(err));\r\n    }\r\n  }\r\n}\r\n\r\nexport default function* recordSaga() {\r\n  yield all([\r\n    takeLatest(loadAllUsersActions.REQUEST, loadAllUsers),\r\n    takeLatest(addUserActions.REQUEST, addUser),\r\n  ]);\r\n}\r\n","import moment from \"moment\";\r\nimport { nanoid } from \"nanoid\";\r\nimport { all, takeLatest, put, select } from \"redux-saga/effects\";\r\nimport { snapshots2Docs, snapshot2Data } from \"../../utils/dbApiUnification\";\r\n\r\nimport {\r\n  loadAllRecordsActions,\r\n  addNewRecordActions,\r\n  updateRecordActions,\r\n  removeRecordActions,\r\n} from \"./action\";\r\nimport { getRecordDB } from \"../../firebase\";\r\n\r\nfunction* loadAllRecords() {\r\n  try {\r\n    const snapshots = yield getRecordDB().orderBy(\"date\", \"desc\").get();\r\n    const docs = snapshots2Docs(snapshots);\r\n    const allRecords = docs.map((snapshot) => ({\r\n      ...snapshot2Data(snapshot),\r\n      id: snapshot.id,\r\n    }));\r\n    yield put(loadAllRecordsActions.success(allRecords));\r\n  } catch (err) {\r\n    yield put(loadAllRecordsActions.failure(err));\r\n  }\r\n}\r\n\r\nfunction* addNewRecord({ data: newRecord }) {\r\n  if (!newRecord) {\r\n    return;\r\n  }\r\n  const id = nanoid();\r\n  const arrangedRecord = { ...newRecord, date: new moment().valueOf(), id };\r\n\r\n  try {\r\n    yield getRecordDB().doc(id).set(arrangedRecord);\r\n    const allRecords = yield select((state) => state?.records?.data || []);\r\n\r\n    yield put(addNewRecordActions.success([arrangedRecord, ...allRecords]));\r\n  } catch (err) {\r\n    yield put(addNewRecordActions.failure(err));\r\n  }\r\n}\r\n\r\nfunction* updateRecord({ data }) {\r\n  const { recordId, updatedRecord } = data;\r\n  const allRecords = yield select((state) => state?.records?.data || []);\r\n  try {\r\n    yield getRecordDB().doc(recordId).set(updatedRecord);\r\n    yield put(\r\n      updateRecordActions.success(\r\n        allRecords.map((record) => (record.id === recordId ? updatedRecord : record))\r\n      )\r\n    );\r\n  } catch (e) {}\r\n}\r\n\r\nfunction* removeRecord({ data }) {\r\n  const { removingId } = data;\r\n  const allRecords = yield select((state) => state?.records?.data || []);\r\n  try {\r\n    yield getRecordDB().doc(removingId).delete();\r\n    yield put(removeRecordActions.success(allRecords.filter(({ id }) => id !== removingId)));\r\n  } catch (e) {\r\n    console.log(e);\r\n  }\r\n}\r\n\r\nexport default function* recordSaga() {\r\n  yield all([\r\n    takeLatest(loadAllRecordsActions.REQUEST, loadAllRecords),\r\n    takeLatest(addNewRecordActions.REQUEST, addNewRecord),\r\n    takeLatest(updateRecordActions.REQUEST, updateRecord),\r\n    takeLatest(removeRecordActions.REQUEST, removeRecord),\r\n  ]);\r\n}\r\n","import { all } from \"redux-saga/effects\";\r\n\r\nimport userSaga from \"./user/saga\";\r\nimport recordSaga from \"./record/saga\";\r\n\r\nexport default function* rootSaga() {\r\n  yield all([userSaga(), recordSaga()]);\r\n}\r\n","import { createStore, applyMiddleware } from \"redux\";\r\nimport records from \"./record/reducer\";\r\nimport users from \"./user/reducer\";\r\n\r\nimport createSagaMiddleware from \"redux-saga\";\r\nimport { combineReducers } from \"redux\";\r\nimport { createLogger } from \"redux-logger\";\r\nimport rootSaga from \"./rootSaga\";\r\n\r\nconst loggerMiddleware = createLogger();\r\n\r\nconst sagaMiddleare = createSagaMiddleware();\r\n\r\nconst store = createStore(\r\n  combineReducers({\r\n    records,\r\n    users,\r\n  }),\r\n  applyMiddleware(sagaMiddleare, loggerMiddleware)\r\n);\r\nsagaMiddleare.run(rootSaga);\r\n\r\nexport default store;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { Provider } from \"react-redux\";\r\nimport \"antd/dist/antd.css\";\r\nimport App from \"./App\";\r\n// import reportWebVitals from \"./reportWebVitals\";\r\nimport store from \"./redux/store\";\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\n// reportWebVitals();\r\n"],"sourceRoot":""}