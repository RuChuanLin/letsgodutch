(this.webpackJsonpletsgodutch=this.webpackJsonpletsgodutch||[]).push([[0],{372:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(37),c=n.n(i),o=n(63),u=(n(254),n(42)),l=n.n(u),s=n(65),d=n(20),b=n(109),j=n.n(b),p=n(165),f=n(190),v=n(189),O=(n(265),new URLSearchParams(window.location.search)),h=Object.fromEntries(O.entries()),x=null;if(h.apiKey&&h.authDomain&&h.projectId)try{f.a.initializeApp(h),x=f.a.firestore()}catch(Ht){x=new v.a("db")}else x=new v.a("db");var m,y=x,g=function(){return y.collection("records")},S=function(){return y.collection("users")},k=function(e){return(null===e||void 0===e?void 0:e.docs)?e.docs:e},w=function(e){return(null===e||void 0===e?void 0:e.data)&&"function"===typeof e.data?e.data():e},C="RECORDS__LOAD_ALL_RECORD",E="RECORDS__ADD_RECORD",I="RECORDS__UPDATE_RECORD",N="RECORDS__REMOVE_RECORD",R=n(67),F="USER__LOAD_ALL_USERS",T="USER__ADD_USER",L=n(22),V=n(36),B=n(43),_=n(44),A=n(376),D=n(74),M=n(374),z=n(382),P=n(383),U=function(){var e={},t=[],n={};return function(r){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{filter:{targeted:!0}};return r===e&&n===a?t:(e=r,n=a,t=Object.entries(r).filter((function(e){return Object.entries(a.filter).every((function(t){var n,r=Object(L.a)(t,2),a=r[0],i=r[1];return(null===e||void 0===e||null===(n=e[1])||void 0===n?void 0:n[a])===i}))})))}}(),G=function(){var e={},t={};return function(n){return n!==e&&(e=n,t={delivery:{fee:0},discount:{amount:0},participants:Object.keys(n).reduce((function(e,t){return Object(d.a)(Object(d.a)({},e),{},Object(R.a)({},t,{key:t,name:t,targeted:!0,selected:!1,cost:""}))}),{}),payer:""}),t}}(),K=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.fixDigit,r=void 0===n?2:n,a=Math.pow(10,r);return Math.round((e+Number.EPSILON)*a)/a},W=n(377),q=n(46),H=n(9),J=Object(_.a)(W.a)(m||(m=Object(B.a)(["\n    &::-webkit-scrollbar {\n        display: none;\n    }\n"]))),Q=function(e){var t=e.button,n=e.buttonTitle,a=void 0===n?"Open Modal":n,i=e.okFunction,c=e.children,o=Object(r.useState)(!1),u=Object(L.a)(o,2),l=u[0],s=u[1],d=function(){s(!0)};return Object(H.jsxs)(H.Fragment,{children:[t?Object(r.cloneElement)(t,{onClick:d}):Object(H.jsx)(q.a,{type:"primary",onClick:d,style:{marginRight:12},children:a}),Object(H.jsx)(J,{visible:l,onOk:function(){i(),s(!1)},onCancel:function(){s(!1)},footer:null,centered:!0,style:{overflow:"auto",maxWidth:"448px"},children:r.Children.map(c,(function(e){return Object(r.cloneElement)(e,{isModalVisible:l,setIsModalVisible:s})}))})]})},X=n(48),Y=n(98),Z=n(68),$=n(62),ee=["children","onSubmit"],te=function(e){var t,n=a.a.Children.toArray(e),r=Object(Z.a)(n);try{for(r.s();!(t=r.n()).done;){var i=t.value;if("StepsList"===i.type.displayName)return i.props.children.length-1}}catch(c){r.e(c)}finally{r.f()}throw new Error("Require StepsList")},ne=function(e){var t=e.children,n=e.onSubmit,a=Object(X.a)(e,ee),i=Object(r.useState)({activeStepIndex:0,totalSteps:te(t),stepTabs:[],direction:0}),c=Object(L.a)(i,2),o=c[0],u=c[1],l=function(){return u(Object($.a)(o,(function(e){e.activeStepIndex=o.activeStepIndex-1,e.direction=-1})))},s=function(){return u(Object($.a)(o,(function(e){e.activeStepIndex=o.activeStepIndex+1,e.direction=1})))},b=n?function(){n(a.values),a.setIsModalVisible(!1),a.setValues(a.initialValues),u(Object($.a)(o,(function(e){e.activeStepIndex=0,e.direction=0})))}:function(){},j=function(e){return u(Object($.a)(o,(function(t){t.stepTabs=e})))},p=function(){var e=null,n=null,i=[];return r.Children.forEach(t,(function(t){"StepsList"===t.type.displayName&&(e=Object(r.cloneElement)(t,Object(d.a)({activeStepIndex:o.activeStepIndex,updateStepTabs:j,direction:o.direction},a)),t.props.validators&&(i=t.props.validators)),"ButtonsList"===t.type.displayName&&(n=Object(r.cloneElement)(t,Object(d.a)({activeStepIndex:o.activeStepIndex,totalSteps:o.totalSteps,submitHandler:b,onNextStep:s,onPreviousStep:l,validators:i},a)))})),{stepsComponent:e,buttonsListComponent:n}}(),f=p.stepsComponent,v=p.buttonsListComponent;return Object(H.jsxs)("div",{children:[f,v]})};ne.displayName="Wizard";var re,ae=ne,ie=["activeStepIndex","children","direction"],ce=_.a.div(re||(re=Object(B.a)(["\n  position: relative;\n  height: 344px;\n"]))),oe=function(e){Object(r.useEffect)((function(){var t=[];r.Children.forEach(e.children,(function(e){e.props.title&&t.push({title:e.props.title})})),e.updateStepTabs(t)}),[]);return Object(H.jsx)(ce,{children:function(){var t=e.activeStepIndex,n=e.children,a=e.direction,i=Object(X.a)(e,ie),c=[];return r.Children.map(n,(function(e,n){return e.props.title&&c.push({title:e.props.title}),Object(r.cloneElement)(e,{isActive:n===t,formik:i,direction:a})}))}()})};oe.displayName="StepsList";var ue=oe,le=n(185),se=["isActive","component","direction"],de=function(e,t){return 300*e*t},be=function(e){var t=e.isActive,n=e.component,r=e.direction,a=Object(X.a)(e,se),i=0===r?50:-20;return Object(le.useTransition)(t,{enter:{x:0,y:0,opacity:1},from:{x:de(r,1),y:i,opacity:0},leave:{x:de(r,-1),y:i,opacity:0}})((function(e,t){return t?Object(H.jsxs)(le.animated.div,{style:Object(d.a)({position:"absolute"},e),children:[Object(H.jsx)(A.a.Title,{level:3,children:null===n||void 0===n?void 0:n.title}),n(a)]}):Object(H.jsx)(H.Fragment,{})}))};be.displayName="Step";var je=be,pe=n(380),fe=n(134),ve=n.n(fe),Oe=n(76),he="#1890ff",xe=ve()(he).darken(.3).hex(),me=ve()(he).brighten(.4).hex(),ye="#FFFFFB",ge={primaryBackground:he,primaryBackgroundDark:xe,primaryBackgroundLight:me,mark:"#C7802D",error:"#f50",white:ye,getGray:function(e){return ve.a.scale([ye,"#080808"])(e).hex()},getbalanceColor:function(e){return ve.a.scale([Oe.c[2],"#fff",Oe.b[2]]).domain([-1e3,1e3])(e).hex()}},Se=["children","type","show","onClick","label","validator"],ke=function(e){var t,n=e.children,i=e.type,c=e.show,o=e.onClick,u=e.label,l=e.validator,s=Object(X.a)(e,Se),b=l&&(null===(t=l.call(null))||void 0===t?void 0:t.errorMsgs)||[],j=Object(r.useState)(!1),p=Object(L.a)(j,2),f=p[0],v=p[1],O="function"===typeof l&&b.length>0;return c?n?a.a.cloneElement(n,{onClick:!l||l.call(null)?o:null,disabled:"function"===typeof l&&!l.call(null)}):Object(H.jsx)(D.a,{title:b&&Object(H.jsx)("span",{children:null===b||void 0===b?void 0:b[0]}),color:ge.error,visible:f,onVisibleChange:function(e){return v(e&&O)},children:Object(H.jsx)(q.a,Object(d.a)(Object(d.a)({disabled:O,type:i,onClick:!l||l.call(null)?o:null},s),{},{children:u||"Next"}))}):null};ke.defaultProps={type:"button"},ke.displayName="WizardButton";var we,Ce=ke,Ee=["activeStepIndex","totalSteps","onPreviousStep","onNextStep","onSubmit","children","validators"],Ie=_.a.div(we||(we=Object(B.a)(["\n  display: flex;\n  justify-content: flex-end;\n  margin-top: 24px;\n"]))),Ne=function(e){var t=e.activeStepIndex,n=e.totalSteps,a=e.onPreviousStep,i=e.onNextStep,c=(e.onSubmit,e.children),o=e.validators,u=Object(X.a)(e,Ee);return Object(H.jsx)(Ie,{children:r.Children.map(c,(function(e){var r=o[t];return"PreviousButton"===e.type.displayName?Object(H.jsx)(Ce,Object(d.a)({type:"link",show:t>0,onClick:a,label:"\u4e0a\u4e00\u6b65"},e.props)):"NextButton"===e.type.displayName?Object(H.jsx)(Ce,Object(d.a)({type:"primary",show:t<n,onClick:i,validator:r,label:"\u4e0b\u4e00\u6b65"},e.props)):"SubmitButton"===e.type.displayName?Object(H.jsx)(Ce,Object(d.a)({show:t===n,onClick:u.submitHandler,validator:r,type:"primary",label:Object(H.jsxs)("span",{children:[Object(H.jsx)(pe.a,{})," \u9001\u51fa"]})},e.props)):e}))})};Ne.displayName="ButtonsList";var Re=Ne,Fe=function(){return null};Fe.displayName="PreviousButton";var Te=Fe,Le=function(){return null};Le.displayName="NextButton";var Ve=Le,Be=function(){return null};Be.displayName="SubmitButton";var _e=Be,Ae=["components","initialValues","onSubmit"];var De=function(e){var t=e.components,n=e.initialValues,r=e.onSubmit,a=Object(X.a)(e,Ae);return Object(H.jsx)(Y.d,{initialValues:n,children:function(e){var i;return Object(H.jsxs)(ae,Object(d.a)(Object(d.a)(Object(d.a)({onSubmit:r,initialValues:n},e),a),{},{children:[Object(H.jsx)(ue,{validators:(i=t.map((function(e){return e.validate||function(){return!0}})),i.map((function(t){return function(){return t(Object(d.a)({},e))}}))),children:t.map((function(e){return Object(H.jsx)(je,{component:e},e.title)}))}),Object(H.jsxs)(Re,Object(d.a)(Object(d.a)({},e),{},{children:[Object(H.jsx)(Te,{}),Object(H.jsx)(Ve,{}),Object(H.jsx)(_e,{})]}))]}))}})},Me=n(375),ze=function(e,t){return U(e,{filter:Object(R.a)({},t,!0)}).map((function(e){return Object(L.a)(e,1)[0]}))},Pe=function(e,t){t.forEach((function(t){var n=t.keys,r=t.action,a=new Set(n);Object.entries(e.participants).forEach((function(t){var n=Object(L.a)(t,2),i=n[0],c=n[1],o=a.has(i);c[r]!==o&&(e.participants[i][r]=o)}))}))},Ue=function(e){var t=e.formik,n=t.values.participants;return Object(H.jsx)(H.Fragment,{children:Object(H.jsx)(Me.a,{dataSource:Object.values(n),titles:["\u672a\u8a02\u9910","\u6709\u8981\u8a02\u9910"],targetKeys:ze(n,"targeted"),selectedKeys:ze(n,"selected"),onChange:function(e){t.setValues(Object($.a)(t.values,(function(t){Pe(t,[{keys:[],action:"selected"},{keys:e,action:"targeted"}])})))},onSelectChange:function(e,n){var r=[].concat(Object(V.a)(e),Object(V.a)(n));t.setValues(Object($.a)(t.values,(function(e){Pe(e,[{keys:r,action:"selected"}])})))},render:function(e){return e.name}})})};Ue.validate=function(e){var t={},n=[],r=e.values.participants;return U(r).length<2&&n.push("\u81f3\u5c11\u9700\u9078\u53d62\u500b\u8a02\u9910\u4eba"),n.length>0&&(t.errorMsgs=n),t},Ue.title="\u8acb\u9078\u64c7\u53c3\u8207\u8a02\u9910\u4eba";var Ge,Ke,We,qe=Ue,He=["type"],Je=Object(_.a)(Y.b)(Ge||(Ge=Object(B.a)(["\n  outline: none;\n  cursor: pointer;\n  width: 155px;\n  height: 36px;\n  border-radius: 2px;\n  border: 1px\n    ","\n    solid;\n  padding-left: 4px;\n  font-size: ","px;\n  transition: 0.2s ease-in-out;\n  &:hover {\n    border: 1px "," solid;\n    background-color: ",";\n  }\n  /* &:focus {\n    background-color: ",";\n    border: 1px "," solid;\n  } */\n  ::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n  ::-webkit-outer-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n"])),(function(e){var t=e.errors,n=e.touched;return t&&n?"red":ge.getGray(.2)}),(function(e){return e.fontSize}),ge.getGray(.25),ge.getGray(.15),ge.white,ge.primaryBackgroundLight),Qe=function(e){var t=e.type,n=void 0===t?"number":t,r=Object(X.a)(e,He);return Object(H.jsx)(Je,Object(d.a)({type:n},r))},Xe=Object(_.a)(A.a.Text)(Ke||(Ke=Object(B.a)(["\n  font-size: ","px;\n"])),(function(e){return null===e||void 0===e?void 0:e.size})),Ye=function(e){var t=e.size,n=void 0===t?16:t,r=e.children;return Object(H.jsx)(Xe,{size:n,children:r})},Ze=_.a.div(We||(We=Object(B.a)(["\n  width: ","px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n  & > * {\n    display: flex;\n  }\n"])),(function(e){return e.width})),$e=function(e){var t=e.text,n=void 0===t?"":t,r=e.width,a=void 0===r?275:r;return Object(H.jsxs)(Ze,{width:a,children:[""===n?Object(H.jsx)(H.Fragment,{}):Object(H.jsx)(Ye,{children:n}),Object(H.jsx)(Qe,Object(d.a)({},e))]})},et=function(e){var t=e.formik,n=t.values.participants;return Object(H.jsx)(H.Fragment,{children:U(n).map((function(e){var n,r,a,i,c,o=Object(L.a)(e,1)[0];return Object(H.jsx)($e,{name:"participants[".concat(o,"].cost"),text:o,value:null===t||void 0===t||null===(n=t.values)||void 0===n||null===(r=n.participants)||void 0===r||null===(a=r[o])||void 0===a?void 0:a.cost,onChange:t.handleChange,onBlur:t.handleBlur,touched:null===t||void 0===t||null===(i=t.touched)||void 0===i||null===(c=i.participants)||void 0===c?void 0:c[o],errors:t.errors[o],placeholder:"enter somthing"},o)}))})};et.validate=function(e){var t={},n=[],r=e.values.participants;return U(r,{filter:{targeted:!0,cost:""}}).length>0&&n.push("\u9700\u586b\u5beb\u6240\u6709\u8a02\u9910\u4eba\u91d1\u984d\u3002\u82e5\u6c92\u6709\u8a02\u9910\u8acb\u56de\u4e0a\u4e00\u6b65\u79fb\u9664\u8a02\u9910\u4eba\u3002"),n.length>0&&(t.errorMsgs=n),t},et.title="\u8acb\u8f38\u5165\u8a02\u9910\u91d1\u984d";var tt=et,nt=n(164),rt=n(378),at=function(e){var t=e.formik,n=t.values,r=n.participants,a=n.payer;return Object(H.jsx)(H.Fragment,{children:Object(H.jsx)(nt.a.Group,{buttonStyle:"solid",value:a,onChange:function(e){t.setValues(Object($.a)(t.values,(function(t){t.payer=e.target.value})))},children:Object(H.jsx)(rt.b,{direction:"vertical",children:U(r).map((function(e){var t=Object(L.a)(e,1)[0];return Object(H.jsx)(nt.a.Button,{value:t,children:t},t)}))})})})};at.validate=function(e){var t={},n=[],r=e.values,a=r.payer,i=r.participants;return a&&i[a].targeted||n.push("\u8acb\u9078\u64c7\u4ed8\u6b3e\u4eba"),n.length>0&&(t.errorMsgs=n),t},at.title="\u8acb\u9078\u64c7\u4ed8\u6b3e\u4eba";var it=at,ct=function(e){var t=e.formik,n=t.values,r=n.delivery,a=n.discount,i=n.note;return Object(H.jsxs)("div",{children:[Object(H.jsx)($e,{text:"\u904b\u8cbb",value:(null===r||void 0===r?void 0:r.fee)||"",onChange:function(e){var n=e.target.value,r=""===n?n:+n;t.setValues(Object($.a)(t.values,(function(e){e.delivery.fee=r})))},placeholder:"\u8acb\u8f38\u5165\u904b\u8cbb"}),Object(H.jsx)($e,{text:"\u512a\u60e0",value:(null===a||void 0===a?void 0:a.amount)||"",onChange:function(e){var n=e.target.value,r=""===n?n:+n;t.setValues(Object($.a)(t.values,(function(e){e.discount.amount=r})))},placeholder:"\u8acb\u8f38\u5165\u512a\u60e0"}),Object(H.jsx)($e,{type:"text",text:"\u5099\u8a3b",value:i||"",onChange:function(e){var n=e.target.value;t.setValues(Object($.a)(t.values,(function(e){e.note=n})))}})]})};ct.title="\u5176\u4ed6\u9078\u9805";var ot=ct,ut=n(381),lt=function(e){var t=e.formik.values,n=function(e){var t=e.delivery.fee,n=void 0===t?0:t,r=e.discount.amount,a=void 0===r?0:r,i=e.participants,c=void 0===i?{}:i,o=e.payer,u=void 0===o?"":o,l=U(c),s=l.reduce((function(e,t){var n=Object(L.a)(t,2);return n[0],e+n[1].cost}),0),d=l.length,b=n-a,j=K(b/d),p=[{title:"\u8a02\u9910\u4eba",dataIndex:"name",key:"name",render:function(e){return Object(H.jsx)(D.a,{title:u===e?"\u4ed8\u6b3e\u4eba":null,children:Object(H.jsxs)(A.a.Text,{strong:!0,children:[u===e&&Object(H.jsx)(ut.a,{twoToneColor:ge.mark}),e]})})}},{title:"\u91d1\u984d",dataIndex:"cost",key:"cost",render:function(e){return Object(H.jsx)(D.a,{title:"".concat(e," ").concat(j>=0?"+":"-"," ").concat(Math.abs(j)),children:Object(H.jsx)(A.a.Link,{target:"_blank",children:K(e+j)})})}}],f=l.map((function(e){var t=Object(L.a)(e,2),n=t[0];return{key:n,name:n,cost:t[1].cost}}));return{discountAmount:a,totalAmount:s,deliveryFee:n,totalSharedFee:b,participantCount:d,sharedFee:j,dataSource:f,columns:p}}(t),r=n.discountAmount,a=n.deliveryFee,i=n.totalAmount,c=n.totalSharedFee,o=n.participantCount,u=n.sharedFee,l=n.dataSource,s=n.columns,d=t.note;return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsxs)(A.a.Text,{strong:!0,children:[u<0?"\u5171\u4eab\u512a\u60e0":"\u5171\u540c\u5206\u64d4","\uff1a"]}),Object(H.jsx)(D.a,{title:"\u904b\u8cbb\uff1a".concat(a,"\uff0c\u512a\u60e0\uff1a").concat(r),children:Object(H.jsx)(A.a.Link,{target:"_blank",children:Math.abs(c)})})," ","\xf7 ",o," = ",Math.abs(u),Object(H.jsx)("br",{}),Object(H.jsx)(A.a.Text,{strong:!0,children:"\u5099\u8a3b\uff1a"}),d||Object(H.jsx)(A.a.Text,{type:"secondary",children:"\u7121\u5099\u8a3b"}),Object(H.jsx)(M.a,{scroll:{y:300},size:"small",pagination:!1,columns:s,dataSource:l,summary:function(){return Object(H.jsx)(M.a.Summary,{fixed:!0,children:Object(H.jsxs)(M.a.Summary.Row,{children:[Object(H.jsx)(M.a.Summary.Cell,{index:0,children:"\u7e3d\u984d"}),Object(H.jsx)(M.a.Summary.Cell,{index:1,children:i+c})]})})}})]})};lt.title="\u7d50\u679c\u9810\u89bd";var st,dt,bt,jt,pt=[qe,tt,it,ot,lt],ft=function(e){var t=e.initialValues,n=e.button,r=e.buttonTitle,a=void 0===r?"\u65b0\u589e\u4e00\u7b46\u8a18\u9304":r,i=e.onSubmit;return Object(H.jsx)(Q,{button:n,buttonTitle:a,children:Object(H.jsx)(De,{initialValues:t,components:pt,onSubmit:i})})},vt=n(379),Ot=["children","popconfirmTitle","onConfirm"],ht=function(e){var t=e.children,n=e.popconfirmTitle,a=void 0===n?"title":n,i=e.onConfirm,c=Object(X.a)(e,Ot),o=Object(r.useState)(!1),u=Object(L.a)(o,2),b=u[0],j=u[1],p=Object(r.useState)(!1),f=Object(L.a)(p,2),v=f[0],O=f[1];Object(r.useEffect)((function(){return function(){j(null),O(null)}}),[]);var h=function(){j(!0)},x=function(){var e=Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),e.next=3,i();case 3:j(!1),O(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(H.jsx)(H.Fragment,{children:Object(H.jsx)(vt.a,{title:a,visible:b,onConfirm:x,okButtonProps:{loading:v},onCancel:function(){j(!1)},onVisibleChange:function(e){e||j(!1)},children:r.Children.map(t,(function(e){return Object(r.cloneElement)(e,Object(d.a)({onClick:h},c))}))})})},xt=["children"],mt=_.a.button(st||(st=Object(B.a)(["\n  outline: none;\n  border: none;\n  background-color: transparent;\n  box-shadow: rgba(99, 99, 99, 0.2) 0px 0px 8px 0px;\n  cursor: pointer;\n  margin: 20px;\n  border-radius: 4px;\n  transition: 1.9s cubic-bezier(0.075, 0.82, 0.165, 1);\n  margin: 4px;\n  &:hover {\n    box-shadow: rgba(20, 20, 20, 0.4) 0px 0px 13px 2px;\n  }\n  &:active {\n    box-shadow: rgba(99, 99, 99, 0.2) 0px 0px 4px 0px;\n    background-color: rgba(99, 99, 99, 0.2);\n  }\n"]))),yt=function(e){var t=e.children,n=Object(X.a)(e,xt);return Object(H.jsx)(mt,Object(d.a)(Object(d.a)({},n),{},{children:t}))},gt=_.a.span(dt||(dt=Object(B.a)(["\n  position: absolute;\n  background: ",";\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  padding-left: 16px;\n"])),(function(e){return e.bgc})),St=A.a.Text,kt=A.a.Link,wt=function(e,t){return e.map((function(e,n){var r=e.date,a=e.participants,i=e.payer,c=e.delivery,o=e.discount,u=e.note,b=e.id,p=(null===c||void 0===c?void 0:c.fee)||0,f=(null===o||void 0===o?void 0:o.amount)||0,v=f-p,O=Object.entries(a).map((function(e){var t=Object(L.a)(e,2),n=t[0],r=t[1],a=r.cost;return{name:n,cost:r.targeted?a:Object(H.jsx)(St,{type:"secondary",children:"\u7121\u53c3\u52a0"})}})).reduce((function(e,t){var n=t.name,r=t.cost;return Object(d.a)(Object(d.a)({},e),Object(R.a)({},n,r))}),{});return Object(d.a)(Object(d.a)({key:"".concat(n+1),date:j()(r).format("M / D"),sharingFee:Object(H.jsx)(D.a,{title:Object(H.jsxs)("div",{children:[Object(H.jsxs)("p",{style:{color:Oe.d[1],margin:0},children:["\u904b\u8cbb\uff1a",p]}),Object(H.jsxs)("p",{style:{color:Oe.b[1],margin:0},children:["\u512a\u60e0\uff1a",f]})]}),children:Object(H.jsx)(kt,{children:v})}),payer:i,discountAmount:f},O),{},{deliveryFee:p,totalAmount:U(a).reduce((function(e,t){var n=Object(L.a)(t,2),r=(n[0],n[1].cost);return e+(void 0===r?0:r)}),p-f),note:u,action:Object(H.jsxs)("div",{children:[Object(H.jsx)(ft,{initialValues:e,button:Object(H.jsx)(D.a,{title:"\u7de8\u8f2f\u6b64\u7b46\u8a18\u9304",placement:"bottomLeft",children:Object(H.jsx)(yt,{children:Object(H.jsx)(z.a,{twoToneColor:Oe.b[5]})})}),onSubmit:function(e){var n,r;t((n=e.id,r=e,function(){var e=Object(s.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g().doc(n).set(r);case 3:t({type:I,payload:{recordId:n,updatedRecord:r}}),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()))},children:"Update"}),Object(H.jsx)(ht,{popconfirmTitle:"\u5373\u5c07\u522a\u9664\u6b64\u7b46\u8a18\u9304",onConfirm:function(){return t((e=b,function(){var t=Object(s.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g().doc(e).delete();case 3:n({type:N,payload:{recordId:e}}),t.next=8;break;case 6:t.prev=6,t.t0=t.catch(0);case 8:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()));var e},children:Object(H.jsx)(D.a,{title:"\u522a\u9664\u6b64\u7b46\u8a18\u9304",placement:"bottomLeft",children:Object(H.jsx)(yt,{children:Object(H.jsx)(P.a,{twoToneColor:Oe.d[5]})})})})]})})}))},Ct=function(e){return e.reduce((function(e,t){var n=t.participants,r=t.payer,a=t.delivery,i=t.discount;if(0===Object.keys(n).length)return e;var c=((null===a||void 0===a?void 0:a.fee)||0)-((null===i||void 0===i?void 0:i.amount)||0),o=U(n),u=c/o.length,l=c;return o.forEach((function(t){var n=Object(L.a)(t,2),r=n[0],a=n[1].cost,i=void 0===a?0:a;e[r]=(e[r]||0)-i-u,l+=i})),e[r]+=l,e}),{})},Et=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.records})),n=function(e){var t=Ct(e),n=Object.keys(t).map((function(e){var n=K(t[e]);return{title:e,render:function(e){return e||0},children:[{title:Object(H.jsx)(gt,{bgc:ge.getbalanceColor(n),children:n}),dataIndex:e,key:e}],balance:n}}));return n.sort((function(e,t){return e.balance-t.balance})),[{title:"\u65e5\u671f",dataIndex:"date",key:"date",width:80,fixed:"left"},{title:"\u4ed8\u6b3e\u4eba",dataIndex:"payer",key:"payer",width:100,fixed:"left"},{title:"\u5171\u4eab",dataIndex:"sharingFee",key:"sharingFee",width:80,fixed:"left"}].concat(Object(V.a)(n),[{title:"\u7e3d\u984d",dataIndex:"totalAmount",key:"totalAmount",fixed:"right",width:75},{title:"\u5099\u8a3b",dataIndex:"note",key:"note",ellipsis:{showTitle:!1},render:function(e){return Object(H.jsx)(D.a,{title:e,children:e})},width:175,fixed:"right"},{title:"Action",dataIndex:"action",key:"action",width:100,fixed:"right"}])}(t),r=wt(t,e);return Object(H.jsx)(M.a,{dataSource:r,columns:n,scroll:{x:1e3},pagination:{pageSize:4}})},It=n(188),Nt=n(131),Rt=Object(_.a)(q.a)(bt||(bt=Object(B.a)(["\n"]))),Ft=function(e){return Object(H.jsx)(Rt,Object(d.a)(Object(d.a)({},e),{},{children:e.children}))},Tt=Nt.a.Option,Lt=_.a.div(jt||(jt=Object(B.a)(["\n  margin-top: 24px;\n"]))),Vt=function(){var e=Object(o.c)((function(e){return e.users})),t=Object(o.b)();return Object(H.jsx)(Q,{buttonTitle:"\u65b0\u589e\u4f7f\u7528\u8005",title:"\u65b0\u589e\u4f7f\u7528\u8005",children:Object(H.jsx)(Y.d,{initialValues:{userName:""},validationSchema:function(){return It.a().shape({userName:It.b().required("\u5fc5\u9808\u586b\u5beb\u4f7f\u7528\u8005\u540d\u7a31")})},children:function(n){var r=n.values.userName;return Object(H.jsxs)(Y.c,{children:[Object(H.jsxs)(Lt,{children:[Object(H.jsx)($e,{type:"text",text:"\u4f7f\u7528\u8005\u540d\u7a31",name:"userName",onChange:n.handleChange,onBlur:n.handleBlur}),Object(H.jsx)(Y.a,{name:"userName"})]}),Object(H.jsx)(Lt,{children:Object(H.jsx)(Nt.a,{style:{width:150},children:Object.entries(e).map((function(e){var t=Object(L.a)(e,1)[0];return Object(H.jsx)(Tt,{children:t},t)}))})}),Object(H.jsx)(Lt,{children:Object(H.jsx)(Ft,{type:"primary",onClick:function(){t(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).userName;return function(){var t=Object(s.a)(l.a.mark((function t(n){var r,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=6;break}return r=Object(p.a)(),a={name:e,date:(new j.a).valueOf(),id:r},t.next=5,S().doc(r).set(a);case 5:n({type:T,payload:Object(d.a)({},a)});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}({userName:r}))},children:"\u65b0\u589e\u4f7f\u7528\u8005"})})]})}})})},Bt=function(){var e=Object(o.c)((function(e){return e.users})),t=G(e),n=Object(o.b)();return Object(H.jsx)(ft,{initialValues:t,buttonTitle:"\u65b0\u589e\u4e00\u7b46\u8cc7\u6599",onSubmit:function(e){var t;n((t=e,function(){var e=Object(s.a)(l.a.mark((function e(n){var r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return r=Object(p.a)(),a=Object(d.a)(Object(d.a)({},t),{},{date:(new j.a).valueOf(),id:r}),e.prev=4,e.next=7,g().doc(r).set(a);case 7:n({type:E,payload:a}),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t){return e.apply(this,arguments)}}()))}})},_t=function(){return Object(H.jsxs)("div",{style:{display:"flex",height:"50px",alignItems:"center",justifyContent:"flex-end"},children:[Object(H.jsx)(Vt,{}),Object(H.jsx)(Bt,{})]})},At=function(){var e=Object(o.b)();return Object(r.useEffect)((function(){e(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).force;return function(t,n){var r=n().records;0===r.length||e?g().orderBy("date","desc").get().then((function(e){var n=k(e).map((function(e){return Object(d.a)(Object(d.a)({},w(e)),{},{id:e.id})}));t({type:C,payload:n})})):t({type:C,payload:r})}}()),e(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).force;return function(t,n){var r=n().users,a=void 0===r?{}:r;(0===Object.keys(a).length||e)&&S().get().then((function(e){var n=k(e).map(w).reduce((function(e,t){return Object(d.a)(Object(d.a)({},e),{},Object(R.a)({},t.name,{}))}),{});t({type:F,payload:n})}))}}())}),[e]),Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(_t,{}),Object(H.jsx)(Et,{})]})},Dt=n(130),Mt=[],zt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E:return[t.payload].concat(Object(V.a)(e));case C:return Object(V.a)(t.payload);case I:var n=t.payload,r=n.recordId,a=n.updatedRecord;return e.map((function(e){return e.id===r?a:e}));case N:return e.filter((function(e){return e.id!==t.payload.recordId}));default:return e}},Pt={},Ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case F:return Object(d.a)({},t.payload);case T:return Object(d.a)(Object(d.a)({},e),{},Object(R.a)({},t.payload.name,Object(d.a)({},t.payload)));default:return e}},Gt=n(234),Kt=n(235),Wt=Object(Kt.createLogger)(),qt=Object(Dt.c)(Object(Dt.b)({records:zt,users:Ut}),Object(Dt.a)(Gt.a,Wt));c.a.render(Object(H.jsx)(o.a,{store:qt,children:Object(H.jsx)(At,{})}),document.getElementById("root"))}},[[372,1,2]]]);
//# sourceMappingURL=main.86ba6d35.chunk.js.map